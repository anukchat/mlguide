
<!DOCTYPE html>


<html lang="en" data-content_root="../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>PyTorch Fundamentals &#8212; Anukool Chaturvedi</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../_static/intro.css?v=ec7e4d73" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/tools/pytorch/00_pytorch_fundamentals';</script>
    <link rel="canonical" href="https://anukchat.github.io/content/tools/pytorch/00_pytorch_fundamentals.html" />
    <link rel="icon" href="../../../_static/mesh-smallest.png"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="PyTorch Workflow Fundamentals" href="01_pytorch_workflow.html" />
    <link rel="prev" title="Pytorch" href="pytorch_toc.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../intro_v2.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../_static/MLGuide_logo_nb.png" class="logo__image only-light" alt="Anukool Chaturvedi - Home"/>
    <script>document.write(`<img src="../../../_static/MLGuide_logo_nb.png" class="logo__image only-dark" alt="Anukool Chaturvedi - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Essentials</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../essentials/intro_python.html">Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../essentials/python/introduction/intro_toc.html">Introduction</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/002_Hello_World.html">Hello World</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/003_Python_Keywords_and_Identifiers.html">Keywords and identifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/004_Python_Statement_Indentation_Comments.html">Statement indentation &amp; comments</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/005_Python_Variables_%26_Constants.html">Variables &amp; constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/006_Python_Literals.html">Literals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/007_Python_Data_Types.html">Datatypes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/008_Python_Type_Conversion.html">Type conversion</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/009_Python_Input_Output_Import.html">I/O &amp; imports</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/010_Python_Operators.html">Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/011_Python_Namespace_and_Scope.html">Namespace &amp; scope</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/introduction/Interpreter_Vs_Compiler.html">Interpreter vs compiler</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../essentials/python/datatypes/datatypes_toc.html">Datatypes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/datatypes/001_Python_Numbers.html">Numbers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/datatypes/002_Python_String.html">String</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/datatypes/003_Python_List.html">List</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/datatypes/004_Python_Tuple.html">Tuple</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/datatypes/005_Python_Dictionary.html">Dictionary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/datatypes/006_Python_Sets.html">Sets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/datatypes/Python_List_Comprehension.html">List comprehension</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../essentials/python/controlflow/controlflow_toc.html">Control flows</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/000_Python_Flow_Control_statement.html">Flow control statement</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/001_Python_if_statement.html">If</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/002_Python_if_else_statement.html">If else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/003_Python_if_elif_else_statement.html">If elif else</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/004_Python_Nested_if_statement.html">Nested if</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/005_Python_for_Loop.html">Loops in Python</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/006_Python_while_Loop.html">Loops in Python</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/controlflow/007_Python_break_continue_pass_statements.html">Break continue &amp; pass</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../essentials/python/functions/functions_toc.html">Functions</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/001_Python_Functions.html">Python Functions</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/002_Python_Function_Global_Local_Nonlocal.html">Global, local and nonlocal</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/003_Python_Function_global_Keywords.html">Python <code class="docutils literal notranslate"><span class="pre">global</span></code> Keyword</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/004_Python_Function_Arguments.html">Function Argument and Parameter</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/005_Python_Function_Recursion.html">Python Recursion</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/006_Python_Function_Anonymous.html">Anonymous</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/007_Python_Function_Module.html">Module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/008_Python_Function_random_Module.html">Random module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/009_Python_Function_math_Module.html">Math module</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/010_Python_Function_Package.html">Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/Python_Docstrings.html">Docstrings</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/functions/Python_User_defined_Functions.html">User defined functions</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../essentials/python/files/files_toc.html">Files</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/files/001_Python_File_Input_Output.html">File I/O</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/files/002_Python_File_Directory.html">File directory</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/files/003_Python_File_Exception.html">File exception</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/files/004_Python_Exceptions_Handling.html">Exceptions handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/files/005_Python_User_defined_Exceptions.html">User defined exceptions</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../essentials/python/objects/objects_toc.html">Objects &amp; classes</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/objects/001_Python_OOPs_Concepts.html">OOPs concepts</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/objects/002_Python_Classes_and_Objects.html">Python  Classes and Objects</a></li>

<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/objects/003_Python_Inheritance.html">Inheritance</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/objects/004_Python_Operator_Overloading.html">Operator overloading</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/objects/self_in_Python_Demystified.html">self demystified</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../essentials/python/advanced/advanced_toc.html">Advanced</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/advanced/001_Python_Iterators.html">Iterators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/advanced/002_Python_Generators.html">Generators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/advanced/003_Python_Closure.html">Closure</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/advanced/004_Python_Decorators.html">Decorators</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/advanced/005_Python_Property.html">Property</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/advanced/006_Python_RegEx.html">RegEx</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../essentials/python/advanced/Python_args_and_kwargs.html">args and kwargs</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../essentials/python/datetime/datetime_toc.html">Date time module</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/001_Python_datetime_Module.html">Datetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/002_Python_strftime.html">strftime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/003_Python_strptime.html">strptime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/004_Python_current_date_and_time.html">Current date &amp; time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/005_Python_get_current_time.html">Current time</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/006_Python_timestamp_to_datetime.html">Timestamp to datetime</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/007_Python_time_Module.html">Time module</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../essentials/python/datetime/008_Python_sleep.html">Sleep</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../essentials/mathematics/mathematics_toc.html">Mathematics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../essentials/mathematics/linear-algebra_vectors.html">Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../essentials/mathematics/linear-algebra_matrices.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../essentials/mathematics/dissimilarity_measures.html">Similarity measure</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../essentials/intro_statistics.html">Statistics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../essentials/statistics/statistics.html">Work in progress</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Tools</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../intro_tools.html">Data analytics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numpy/numpy_toc.html">NumPy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../numpy/001_Python_NumPy.html">Python NumPy</a></li>

<li class="toctree-l3"><a class="reference internal" href="../numpy/002_Python_NumPy_Array_Part1.html">Arrays Part 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numpy/003_Python_NumPy_Array_Part2.html">Arrays Part 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numpy/004_Python_NumPy_Array_Part3.html">Arrays Part 3</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numpy/005_Python_NumPy_Array_Part4.html">Arrays Part 4</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numpy/Python_Numpy_Exercises_with_hints.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../pandas/pandas_toc.html">Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_DataFrame.html">Python Pandas</a></li>

<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/001_Python_Pandas_DataFrame_from_Dictionary.html">Dataframe from dictionary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/002_Python_Pandas_DataFrame_from_List.html">Dataframe from List</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/003_Python_Pandas_DataFrame_head_and_tail.html">Head &amp; tail</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/004_Python_Pandas_DataFrame_drop_columns.html">Drop columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/005_Python_Pandas_DataFrame_drop_duplicates.html">Drop duplicates</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/006_Python_Pandas_DataFrame_drop_columns_with_NA.html">Drop with NA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/007_Python_Pandas_DataFrame_rename_columns.html">Rename columns</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/008_Python_Pandas_DataFrame_to_Python_dictionary.html">Dataframe to python dictionary</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/009_Python_Pandas_DataFrame_set_index.html">Set index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/001_Python_Pandas_Methods/010_Python_Pandas_DataFrame_reset_index.html">Reset index</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/002_Python_Pandas_Exercise_1.html">Exercise 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pandas/003_Python_Pandas_Exercise_2.html">Exercise 2</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../matplotlib/matplotlib_toc.html">Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../matplotlib/002_Python_Matplotlib_Exercise_1.html">Matplotlib</a></li>

<li class="toctree-l3"><a class="reference internal" href="../matplotlib/003_Python_Matplotlib_Exercise_2.html">Matplotlib 2</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../seaborn/seaborn_toc.html">Seaborn</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/001_Seaborn_Loading_Dataset.html">Loading Dataset</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/002_Seaborn_Controlling_Aesthetics.html">Controlling aesthetics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/003_Matplotlib_vs_Seaborn.html">Matplotlib vs seaborn</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/004_Seaborn_Color_Palettes.html">Color palettes</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/005_Seaborn_LM_Plot_and_Reg_Plot.html">LM and regerssion plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/006_Seaborn_Scatter_Plot_and_Joint_Plot.html">Scatter and join plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/007_Seaborn_Additional_Regression_Plots.html">Regerssion plots</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/008_Seaborn_Distribution_Plots.html">Seaborn distribution plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/009_Seaborn_Categorical_Swarm_Plot.html">Categorical swarn plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/010_Seaborn_Categorical_Strip_Plot.html">Categorical strip plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/011_Seaborn_Categorical_Box_Plot.html">Categorical box plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/012_Seaborn_Categorical_Violin_Plot.html">Categorical violin plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/013_Seaborn_Categorical_Bar_Plot_Point_Plot_and_Count_Plot.html">Categorical bar, point &amp; count plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/014_Seaborn_Categorical_Factor_Plot.html">Categorical factor plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/015_Seaborn_TimeSeries_and_LetterValue_Plot.html">Timeseries and letter value plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/016_Seaborn_PairGrid_Plot.html">Pair grid Pplot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/017_Seaborn_FacetGrid_Plot.html">Facet grid plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/018_Seaborn_Heat_Map.html">Heat map</a></li>
<li class="toctree-l3"><a class="reference internal" href="../seaborn/019_Seaborn_Cluster_Map.html">Cluster map</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../tools-for-nn.html">Neural networks</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="pytorch_toc.html">Pytorch</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Fundamentals</a></li>
<li class="toctree-l3"><a class="reference internal" href="01_pytorch_workflow.html">Workflows</a></li>
<li class="toctree-l3"><a class="reference internal" href="02_pytorch_classification.html">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="03_pytorch_computer_vision.html">Computer vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="04_pytorch_custom_datasets.html">Custom datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="05_pytorch_going_modular.html">Going Modular</a></li>
<li class="toctree-l3"><a class="reference internal" href="06_pytorch_transfer_learning.html">Transfer learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="07_pytorch_experiment_tracking.html">Experiment tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="08_pytorch_paper_replicating.html">Replicating papers</a></li>
<li class="toctree-l3"><a class="reference internal" href="09_pytorch_model_deployment.html">Model deployment</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../tools-for-llms.html">LLMs</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../langchain/langchain_toc.html">Langchain</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../langchain/LangChain%20Cookbook%20Part%201%20-%20Fundamentals.html">LangChain Cookbook 👨‍🍳👩‍🍳</a></li>

<li class="toctree-l3"><a class="reference internal" href="../langchain/LangChain%20Cookbook%20Part%202%20-%20Use%20Cases.html">LangChain Cookbook Part 2: Use Cases👨‍🍳👩‍🍳</a></li>

<li class="toctree-l3"><a class="reference internal" href="../langchain/projects/project_toc.html">Projects gallery</a></li>
<li class="toctree-l3"><a class="reference internal" href="../langchain/langsmith.html">LangSmith</a></li>
<li class="toctree-l3"><a class="reference internal" href="../langchain/langgraph.html">LangGraph</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../hf/intro.html">HuggingFace introduction and setup</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Concepts</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../concepts/concepts.html">Concepts at glance</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/linear-regression.html">Linear regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/logistic-regression.html">Logistic regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/k-means.html">K-means</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/anomaly-detection.html">Anomaly detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../concepts/neural-networks.html">Neural networks</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Blogs &amp; resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../resources/blogs/blogs_toc.html">Blogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/papers/papers_toc.html">Research papers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/books/books_toc.html">E-Books</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../resources/courses/courses_toc.html">Courses</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About me</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../intro_me.html">About me</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/anukchat/anukchat.github.io/main?urlpath=lab/tree/content/tools/pytorch/00_pytorch_fundamentals.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/anukchat/anukchat.github.io/blob/main/content/tools/pytorch/00_pytorch_fundamentals.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../_sources/content/tools/pytorch/00_pytorch_fundamentals.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>PyTorch Fundamentals</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pytorch">What is PyTorch?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-can-pytorch-be-used-for">What can PyTorch be used for?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#who-uses-pytorch">Who uses PyTorch?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-pytorch">Why use PyTorch?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-were-going-to-cover-in-this-module">What we’re going to cover in this module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-pytorch">Importing PyTorch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-tensors">Introduction to tensors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-tensors">Creating tensors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar">Scalar</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices">Matrices</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tensors">Tensors</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-tensors">Random tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zeros-and-ones">Zeros and ones</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-range-and-tensors-like">Creating a range and tensors like</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-datatypes">Tensor datatypes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-information-from-tensors">Getting information from tensors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-tensors-tensor-operations">Manipulating tensors (tensor operations)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-operations">Basic operations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-multiplication-is-all-you-need">Matrix multiplication (is all you need)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-of-the-most-common-errors-in-deep-learning-shape-errors">One of the most common errors in deep learning (shape errors)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-min-max-mean-sum-etc-aggregation">Finding the min, max, mean, sum, etc (aggregation)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#positional-min-max">Positional min/max</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-tensor-datatype">Change tensor datatype</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-stacking-squeezing-and-unsqueezing">Reshaping, stacking, squeezing and unsqueezing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing-selecting-data-from-tensors">Indexing (selecting data from tensors)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pytorch-tensors-numpy">PyTorch tensors &amp; NumPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#significance-of-random-seeding">Significance of random seeding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-tensors-on-gpus-and-making-faster-computations">Running tensors on GPUs (and making faster computations)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-a-gpu">1. Getting a GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pytorch-to-run-on-the-gpu">2. Getting PyTorch to run on the GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pytorch-to-run-on-apple-silicon">2.1 Getting PyTorch to run on Apple Silicon</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-tensors-and-models-on-the-gpu">3. Putting tensors (and models) on the GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-tensors-back-to-the-cpu">4. Moving tensors back to the CPU</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="pytorch-fundamentals">
<h1>PyTorch Fundamentals<a class="headerlink" href="#pytorch-fundamentals" title="Link to this heading">#</a></h1>
<section id="what-is-pytorch">
<h2>What is PyTorch?<a class="headerlink" href="#what-is-pytorch" title="Link to this heading">#</a></h2>
<p><a class="reference external" href="https://pytorch.org/">PyTorch</a> is an open source machine learning and deep learning framework.</p>
</section>
<section id="what-can-pytorch-be-used-for">
<h2>What can PyTorch be used for?<a class="headerlink" href="#what-can-pytorch-be-used-for" title="Link to this heading">#</a></h2>
<p>PyTorch allows you to manipulate and process data and write machine learning algorithms using Python code.</p>
</section>
<section id="who-uses-pytorch">
<h2>Who uses PyTorch?<a class="headerlink" href="#who-uses-pytorch" title="Link to this heading">#</a></h2>
<p>Many of the worlds largest technology companies such as <a class="reference external" href="https://ai.facebook.com/blog/pytorch-builds-the-future-of-ai-and-machine-learning-at-facebook/">Meta (Facebook)</a>, Tesla and Microsoft as well as artificial intelligence research companies such as <a class="reference external" href="https://openai.com/blog/openai-pytorch/">OpenAI use PyTorch</a> to power research and bring machine learning to their products.</p>
<p><img alt="pytorch being used across industry and research" src="../../../_images/00-pytorch-being-used-across-research-and-industry.png" /></p>
<p>For example, Andrej Karpathy (head of AI at Tesla) has given several talks (<a class="reference external" href="https://youtu.be/oBklltKXtDE">PyTorch DevCon 2019</a>, <a class="reference external" href="https://youtu.be/j0z4FweCy4M?t=2904">Tesla AI Day 2021</a>) about how Tesla use PyTorch to power their self-driving computer vision models.</p>
<p>PyTorch is also used in other industries such as agriculture to <a class="reference external" href="https://medium.com/pytorch/ai-for-ag-production-machine-learning-for-agriculture-e8cfdb9849a1">power computer vision on tractors</a>.</p>
</section>
<section id="why-use-pytorch">
<h2>Why use PyTorch?<a class="headerlink" href="#why-use-pytorch" title="Link to this heading">#</a></h2>
<p>Machine learning researchers love using PyTorch. And as of February 2022, PyTorch is the <a class="reference external" href="https://paperswithcode.com/trends">most used deep learning framework on Papers With Code</a>, a website for tracking machine learning research papers and the code repositories attached with them.</p>
<p>PyTorch also helps take care of many things such as GPU acceleration (making your code run faster) behind the scenes.</p>
<p>So you can focus on manipulating data and writing algorithms and PyTorch will make sure it runs fast.</p>
<p>And if companies such as Tesla and Meta (Facebook) use it to build models they deploy to power hundreds of applications, drive thousands of cars and deliver content to billions of people, it’s clearly capable on the development front too.</p>
</section>
<section id="what-were-going-to-cover-in-this-module">
<h2>What we’re going to cover in this module<a class="headerlink" href="#what-were-going-to-cover-in-this-module" title="Link to this heading">#</a></h2>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Topic</strong></p></th>
<th class="head"><p><strong>Contents</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Introduction to tensors</strong></p></td>
<td><p>Tensors are the basic building block of all of machine learning and deep learning.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Creating tensors</strong></p></td>
<td><p>Tensors can represent almost any kind of data (images, words, tables of numbers).</p></td>
</tr>
<tr class="row-even"><td><p><strong>Getting information from tensors</strong></p></td>
<td><p>If you can put information into a tensor, you’ll want to get it out too.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Manipulating tensors</strong></p></td>
<td><p>Machine learning algorithms (like neural networks) involve manipulating tensors in many different ways such as adding, multiplying, combining.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Dealing with tensor shapes</strong></p></td>
<td><p>One of the most common issues in machine learning is dealing with shape mismatches (trying to mixed wrong shaped tensors with other tensors).</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Indexing on tensors</strong></p></td>
<td><p>If you’ve indexed on a Python list or NumPy array, it’s very similar with tensors, except they can have far more dimensions.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Mixing PyTorch tensors and NumPy</strong></p></td>
<td><p>PyTorch plays with tensors (<a class="reference external" href="https://pytorch.org/docs/stable/tensors.html"><code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a>), NumPy likes arrays (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html"><code class="docutils literal notranslate"><span class="pre">np.ndarray</span></code></a>) sometimes you’ll want to mix and match these.</p></td>
</tr>
<tr class="row-odd"><td><p><strong>Reproducibility</strong></p></td>
<td><p>Machine learning is very experimental and since it uses a lot of <em>randomness</em> to work, sometimes you’ll want that <em>randomness</em> to not be so random.</p></td>
</tr>
<tr class="row-even"><td><p><strong>Running tensors on GPU</strong></p></td>
<td><p>GPUs (Graphics Processing Units) make your code faster, PyTorch makes it easy to run your code on GPUs.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="importing-pytorch">
<h2>Importing PyTorch<a class="headerlink" href="#importing-pytorch" title="Link to this heading">#</a></h2>
<blockquote>
<div><p><strong>Note:</strong> Before running any of the code in this notebook, you should have gone through the <a class="reference external" href="https://pytorch.org/get-started/locally/">PyTorch setup steps</a>.</p>
<p>However, <strong>if you’re running on Google Colab</strong>, everything should work (Google Colab comes with PyTorch and other libraries installed).</p>
</div></blockquote>
<p>Let’s start by importing PyTorch and checking the version we’re using.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">torch</span><span class="o">.</span><span class="n">__version__</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;1.13.1+cu116&#39;
</pre></div>
</div>
</div>
</div>
</section>
<section id="introduction-to-tensors">
<h2>Introduction to tensors<a class="headerlink" href="#introduction-to-tensors" title="Link to this heading">#</a></h2>
<p>Tensors are the fundamental building block of machine learning.</p>
<p>Their job is to represent data in a numerical way.</p>
<p>For example, you could represent an image as a tensor with shape <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">224,</span> <span class="pre">224]</span></code> which would mean <code class="docutils literal notranslate"><span class="pre">[colour_channels,</span> <span class="pre">height,</span> <span class="pre">width]</span></code>, as in the image has <code class="docutils literal notranslate"><span class="pre">3</span></code> colour channels (red, green, blue), a height of <code class="docutils literal notranslate"><span class="pre">224</span></code> pixels and a width of <code class="docutils literal notranslate"><span class="pre">224</span></code> pixels.</p>
<p><img alt="example of going from an input image to a tensor representation of the image, image gets broken down into 3 colour channels as well as numbers to represent the height and width" src="../../../_images/00-tensor-shape-example-of-image.png" /></p>
<p>In tensor-speak (the language used to describe tensors), the tensor would have three dimensions, one for <code class="docutils literal notranslate"><span class="pre">colour_channels</span></code>, <code class="docutils literal notranslate"><span class="pre">height</span></code> and <code class="docutils literal notranslate"><span class="pre">width</span></code>.</p>
<section id="creating-tensors">
<h3>Creating tensors<a class="headerlink" href="#creating-tensors" title="Link to this heading">#</a></h3>
<p><strong>Reference</strong>: <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html"><code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code></a> class.</p>
<section id="scalar">
<h4>Scalar<a class="headerlink" href="#scalar" title="Link to this heading">#</a></h4>
<p>A scalar is a single number and in tensor-speak it’s a zero dimension tensor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Scalar</span>
<span class="n">scalar</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="n">scalar</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(7)
</pre></div>
</div>
</div>
</div>
<p>Check the dimensions of a tensor using the <code class="docutils literal notranslate"><span class="pre">ndim</span></code> attribute.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">scalar</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
</div>
</div>
<p>Use <code class="docutils literal notranslate"><span class="pre">item()</span></code> method to retrieve the number from the tensor</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the Python number within a tensor (only works with one-element tensors)</span>
<span class="n">scalar</span><span class="o">.</span><span class="n">item</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>7
</pre></div>
</div>
</div>
</div>
</section>
<section id="vectors">
<h4>Vectors<a class="headerlink" href="#vectors" title="Link to this heading">#</a></h4>
<p>A vector is a single dimension tensor but can contain many numbers.</p>
<p>As in, you could have a vector <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">2]</span></code> to describe <code class="docutils literal notranslate"><span class="pre">[bedrooms,</span> <span class="pre">bathrooms]</span></code> in your house. Or you could have <code class="docutils literal notranslate"><span class="pre">[3,</span> <span class="pre">2,</span> <span class="pre">2]</span></code> to describe <code class="docutils literal notranslate"><span class="pre">[bedrooms,</span> <span class="pre">bathrooms,</span> <span class="pre">car_parks]</span></code> in your house.</p>
<p>A vector is flexible in what it can represent (the same with tensors).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Vector</span>
<span class="n">vector</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">7</span><span class="p">])</span>
<span class="n">vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([7, 7])
</pre></div>
</div>
</div>
</div>
<p>Let’s check its dimensions</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check the number of dimensions of vector</span>
<span class="n">vector</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">vector</span></code> contains two numbers but only has a single dimension.</p>
<p><strong>Trick</strong>: A tensor in PyTorch has by the number of square brackets on the outside (<code class="docutils literal notranslate"><span class="pre">[</span></code>) and you only need to count one side.</p>
<p>To know how many elements are present inside of any dimension vector, use <code class="docutils literal notranslate"><span class="pre">shape</span></code> attribute. The shape tells you how the elements inside them are arranged.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check shape of vector</span>
<span class="n">vector</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([2])
</pre></div>
</div>
</div>
</div>
<p>Two elements we placed inside the square brackets (<code class="docutils literal notranslate"><span class="pre">[7,</span> <span class="pre">7]</span></code>).</p>
</section>
<section id="matrices">
<h4>Matrices<a class="headerlink" href="#matrices" title="Link to this heading">#</a></h4>
<p>Let’s now see a <strong>matrix</strong>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matrix</span>
<span class="n">MATRIX</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">],</span> 
                       <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">]])</span>
<span class="n">MATRIX</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[ 7,  8],
        [ 9, 10]])
</pre></div>
</div>
</div>
</div>
<p>Matrices are as flexible as vectors, except they’ve got an extra dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check number of dimensions</span>
<span class="n">MATRIX</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MATRIX</span></code> has two dimensions</p>
<p>Let’s check its shape</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">MATRIX</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([2, 2])
</pre></div>
</div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">MATRIX</span></code> is two elements deep and two elements wide.</p>
</section>
<section id="tensors">
<h4>Tensors<a class="headerlink" href="#tensors" title="Link to this heading">#</a></h4>
<p>Let’s create a <strong>tensor</strong>: A scalar, vector , matrice , all can be represented in tensor, along with a more than 2 dimensional (n dimensions) can be represented as a Tensor</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tensor</span>
<span class="n">TENSOR</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
                        <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]])</span>
<span class="n">TENSOR</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[[1, 2, 3],
         [3, 6, 9],
         [2, 4, 5]]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check number of dimensions for TENSOR</span>
<span class="n">TENSOR</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>3
</pre></div>
</div>
</div>
</div>
<p>And what about its shape?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check shape of TENSOR</span>
<span class="n">TENSOR</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([1, 3, 3])
</pre></div>
</div>
</div>
</div>
<p>The dimensions go outer to inner.</p>
<p>That means there’s 1 dimension of 3 by 3.</p>
<p><img alt="example of different tensor dimensions" src="../../../_images/00-pytorch-different-tensor-dimensions.png" /></p>
<blockquote>
<div><p><strong>Note:</strong> We used lowercase letters for <code class="docutils literal notranslate"><span class="pre">scalar</span></code> and <code class="docutils literal notranslate"><span class="pre">vector</span></code> and uppercase letters for <code class="docutils literal notranslate"><span class="pre">MATRIX</span></code> and <code class="docutils literal notranslate"><span class="pre">TENSOR</span></code>. In practice, you’ll often see scalars and vectors denoted as lowercase letters such as <code class="docutils literal notranslate"><span class="pre">y</span></code> or <code class="docutils literal notranslate"><span class="pre">a</span></code>. And matrices and tensors denoted as uppercase letters such as <code class="docutils literal notranslate"><span class="pre">X</span></code> or <code class="docutils literal notranslate"><span class="pre">W</span></code>.</p>
<p>You also might notice the names martrix and tensor used interchangably. This is common. Since in PyTorch you’re often dealing with <code class="docutils literal notranslate"><span class="pre">torch.Tensor</span></code>s (hence the tensor name), however, the shape and dimensions of what’s inside will dictate what it actually is.</p>
</div></blockquote>
<p>Let’s summarise.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>What is it?</p></th>
<th class="head"><p>Number of dimensions</p></th>
<th class="head"><p>Lower or upper (usually/example)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>scalar</strong></p></td>
<td><p>a single number</p></td>
<td><p>0</p></td>
<td><p>Lower (<code class="docutils literal notranslate"><span class="pre">a</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>vector</strong></p></td>
<td><p>a number with direction (e.g. wind speed with direction) but can also have many other numbers</p></td>
<td><p>1</p></td>
<td><p>Lower (<code class="docutils literal notranslate"><span class="pre">y</span></code>)</p></td>
</tr>
<tr class="row-even"><td><p><strong>matrix</strong></p></td>
<td><p>a 2-dimensional array of numbers</p></td>
<td><p>2</p></td>
<td><p>Upper (<code class="docutils literal notranslate"><span class="pre">Q</span></code>)</p></td>
</tr>
<tr class="row-odd"><td><p><strong>tensor</strong></p></td>
<td><p>an n-dimensional array of numbers</p></td>
<td><p>can be any number, a 0-dimension tensor is a scalar, a 1-dimension tensor is a vector</p></td>
<td><p>Upper (<code class="docutils literal notranslate"><span class="pre">X</span></code>)</p></td>
</tr>
</tbody>
</table>
</div>
<p><img alt="scalar vector matrix tensor and what they look like" src="../../../_images/00-scalar-vector-matrix-tensor.png" /></p>
</section>
</section>
<section id="random-tensors">
<h3>Random tensors<a class="headerlink" href="#random-tensors" title="Link to this heading">#</a></h3>
<p>Machine learning models such as neural networks manipulate and seek patterns within tensors.</p>
<p>Building machine learning models with PyTorch, it’s rare you’ll create tensors by hand (like what we’ve being doing).</p>
<p>A machine learning model often starts out with large random tensors of numbers and adjusts these random numbers as it works through data to better represent it.</p>
<p>In essence:</p>
<p><code class="docutils literal notranslate"><span class="pre">Start</span> <span class="pre">with</span> <span class="pre">random</span> <span class="pre">numbers</span> <span class="pre">-&gt;</span> <span class="pre">look</span> <span class="pre">at</span> <span class="pre">data</span> <span class="pre">-&gt;</span> <span class="pre">update</span> <span class="pre">random</span> <span class="pre">numbers</span> <span class="pre">-&gt;</span> <span class="pre">look</span> <span class="pre">at</span> <span class="pre">data</span> <span class="pre">-&gt;</span> <span class="pre">update</span> <span class="pre">random</span> <span class="pre">numbers...</span></code></p>
<p>let’s see how to create a tensor of random numbers.</p>
<p>We can do so using <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.rand.html"><code class="docutils literal notranslate"><span class="pre">torch.rand()</span></code></a> and passing in the <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a random tensor of size (3, 4)</span>
<span class="n">random_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">random_tensor</span><span class="p">,</span> <span class="n">random_tensor</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[0.6541, 0.4807, 0.2162, 0.6168],
         [0.4428, 0.6608, 0.6194, 0.8620],
         [0.2795, 0.6055, 0.4958, 0.5483]]),
 torch.float32)
</pre></div>
</div>
</div>
</div>
<p>The flexibility of <code class="docutils literal notranslate"><span class="pre">torch.rand()</span></code> is that we can adjust the <code class="docutils literal notranslate"><span class="pre">size</span></code> to be whatever we want.</p>
<p>For example, say you wanted a random tensor in the common image shape of <code class="docutils literal notranslate"><span class="pre">[224,</span> <span class="pre">224,</span> <span class="pre">3]</span></code> (<code class="docutils literal notranslate"><span class="pre">[height,</span> <span class="pre">width,</span> <span class="pre">color_channels</span></code>]).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a random tensor of size (224, 224, 3)</span>
<span class="n">random_image_size_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="n">random_image_size_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">random_image_size_tensor</span><span class="o">.</span><span class="n">ndim</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(torch.Size([224, 224, 3]), 3)
</pre></div>
</div>
</div>
</div>
</section>
<section id="zeros-and-ones">
<h3>Zeros and ones<a class="headerlink" href="#zeros-and-ones" title="Link to this heading">#</a></h3>
<p>Sometimes you’ll just want to fill tensors with zeros or ones.</p>
<p>Let’s create a tensor full of zeros with <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.zeros.html"><code class="docutils literal notranslate"><span class="pre">torch.zeros()</span></code></a></p>
<p>Again, the <code class="docutils literal notranslate"><span class="pre">size</span></code> parameter comes into play.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor of all zeros</span>
<span class="n">zeros</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">zeros</span><span class="p">,</span> <span class="n">zeros</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[0., 0., 0., 0.],
         [0., 0., 0., 0.],
         [0., 0., 0., 0.]]),
 torch.float32)
</pre></div>
</div>
</div>
</div>
<p>We can do the same to create a tensor of all ones except using <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.ones.html"><code class="docutils literal notranslate"><span class="pre">torch.ones()</span></code> </a> instead.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor of all ones</span>
<span class="n">ones</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">ones</span><span class="p">,</span> <span class="n">ones</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[1., 1., 1., 1.],
         [1., 1., 1., 1.],
         [1., 1., 1., 1.]]),
 torch.float32)
</pre></div>
</div>
</div>
</div>
</section>
<section id="creating-a-range-and-tensors-like">
<h3>Creating a range and tensors like<a class="headerlink" href="#creating-a-range-and-tensors-like" title="Link to this heading">#</a></h3>
<p>Sometimes you might want a range of numbers, such as 1 to 10 or 0 to 100.</p>
<p>You can use <code class="docutils literal notranslate"><span class="pre">torch.arange(start,</span> <span class="pre">end,</span> <span class="pre">step)</span></code> to do so.</p>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">start</span></code> = start of range (e.g. 0)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">end</span></code> = end of range (e.g. 10)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step</span></code> = how many steps in between each value (e.g. 1)</p></li>
</ul>
<blockquote>
<div><p><strong>Note:</strong> In Python, you can use <code class="docutils literal notranslate"><span class="pre">range()</span></code> to create a range. However in PyTorch, <code class="docutils literal notranslate"><span class="pre">torch.range()</span></code> is deprecated and may show an error in the future.</p>
</div></blockquote>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use torch.arange(), torch.range() is deprecated </span>
<span class="n">zero_to_ten_deprecated</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="c1"># Note: this may return an error in the future</span>

<span class="c1"># Create a range of values 0 to 10</span>
<span class="n">zero_to_ten</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">zero_to_ten</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>/tmp/ipykernel_3695928/193451495.py:2: UserWarning: torch.range is deprecated and will be removed in a future release because its behavior is inconsistent with Python&#39;s range builtin. Instead, use torch.arange, which produces values in [start, end).
  zero_to_ten_deprecated = torch.range(0, 10) # Note: this may return an error in the future
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([0, 1, 2, 3, 4, 5, 6, 7, 8, 9])
</pre></div>
</div>
</div>
</div>
<p>Sometimes you might want one tensor of a certain type with the same shape as another tensor.</p>
<p>For example, a tensor of all zeros with the same shape as a previous tensor.</p>
<p>To do so you can use <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.zeros_like.html"><code class="docutils literal notranslate"><span class="pre">torch.zeros_like(input)</span></code></a> or <a class="reference external" href="https://pytorch.org/docs/1.9.1/generated/torch.ones_like.html"><code class="docutils literal notranslate"><span class="pre">torch.ones_like(input)</span></code></a> which return a tensor filled with zeros or ones in the same shape as the <code class="docutils literal notranslate"><span class="pre">input</span></code> respectively.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Can also create a tensor of zeros similar to another tensor</span>
<span class="n">ten_zeros</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="nb">input</span><span class="o">=</span><span class="n">zero_to_ten</span><span class="p">)</span> <span class="c1"># will have same shape</span>
<span class="n">ten_zeros</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([0, 0, 0, 0, 0, 0, 0, 0, 0, 0])
</pre></div>
</div>
</div>
</div>
</section>
<section id="tensor-datatypes">
<h3>Tensor datatypes<a class="headerlink" href="#tensor-datatypes" title="Link to this heading">#</a></h3>
<p><strong>Reference</strong>: <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#data-types">tensor datatypes available in PyTorch</a>.</p>
<p>Some datatypes are specific for CPU and some are better for GPU.</p>
<p>If you see <code class="docutils literal notranslate"><span class="pre">torch.cuda</span></code> anywhere, the tensor is being used for GPU (since Nvidia GPUs use a computing toolkit called CUDA).</p>
<p>The most common type (and generally the default) is <code class="docutils literal notranslate"><span class="pre">torch.float32</span></code> or <code class="docutils literal notranslate"><span class="pre">torch.float</span></code>. This is referred to as “32-bit floating point”.</p>
<p>But there’s also 16-bit floating point (<code class="docutils literal notranslate"><span class="pre">torch.float16</span></code> or <code class="docutils literal notranslate"><span class="pre">torch.half</span></code>) and 64-bit floating point (<code class="docutils literal notranslate"><span class="pre">torch.float64</span></code> or <code class="docutils literal notranslate"><span class="pre">torch.double</span></code>).</p>
<p>Pytorch also have 8-bit, 16-bit, 32-bit and 64-bit integers.</p>
<p>Plus more!</p>
<p>The reason for all of these is to do with <strong>precision in computing</strong>.</p>
<p>Precision is the amount of detail used to describe a number.</p>
<p>The higher the precision value (8, 16, 32), the more detail and hence data used to express a number.</p>
<p>This matters in deep learning and numerical computing because you’re making so many operations, the more detail you have to calculate on, the more compute you have to use.</p>
<p>So lower precision datatypes are generally faster to compute on but sacrifice some performance on evaluation metrics like accuracy (faster to compute but less accurate).</p>
<blockquote>
<div><p><strong>Resources:</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>See the <a class="reference external" href="https://pytorch.org/docs/stable/tensors.html#data-types">PyTorch documentation for a list of all available tensor datatypes</a>.</p></li>
<li><p>Read the <a class="reference external" href="https://en.wikipedia.org/wiki/Precision_(computer_science)">Wikipedia page for an overview of what precision in computing</a> is.</p></li>
</ul>
<p>Let’s see how to create some tensors with specific datatypes. We can do so using the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Default datatype for tensors is float32</span>
<span class="n">float_32_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">],</span>
                               <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># defaults to None, which is torch.float32 or whatever datatype is passed</span>
                               <span class="n">device</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="c1"># defaults to None, which uses the default tensor type</span>
                               <span class="n">requires_grad</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="c1"># if True, operations performed on the tensor are recorded </span>

<span class="n">float_32_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">float_32_tensor</span><span class="o">.</span><span class="n">dtype</span><span class="p">,</span> <span class="n">float_32_tensor</span><span class="o">.</span><span class="n">device</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(torch.Size([3]), torch.float32, device(type=&#39;cpu&#39;))
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong></p>
</div></blockquote>
<ul class="simple">
<li><p>Aside from shape issues (tensor shapes don’t match up), two of the other most common issues you’ll come across in PyTorch are datatype and device issues.</p></li>
<li><p>For example, one of tensors is <code class="docutils literal notranslate"><span class="pre">torch.float32</span></code> and the other is <code class="docutils literal notranslate"><span class="pre">torch.float16</span></code> (PyTorch often likes tensors to be the same format).</p></li>
<li><p>Or one of the tensors is on the CPU and the other is on the GPU (PyTorch likes calculations between tensors to be on the same device).</p></li>
</ul>
<p>Let’s create a tensor with <code class="docutils literal notranslate"><span class="pre">dtype=torch.float16</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">float_16_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">6.0</span><span class="p">,</span> <span class="mf">9.0</span><span class="p">],</span>
                               <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span> <span class="c1"># torch.half would also work</span>

<span class="n">float_16_tensor</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.float16
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="getting-information-from-tensors">
<h2>Getting information from tensors<a class="headerlink" href="#getting-information-from-tensors" title="Link to this heading">#</a></h2>
<p>Once you’ve created tensors , you might want to get some information from them.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code> - what shape is the tensor? (some operations require specific shape rules)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code> - what datatype are the elements within the tensor stored in?</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">device</span></code> - what device is the tensor stored on? (usually GPU or CPU)</p></li>
</ul>
<p>Let’s create a random tensor and find out details about it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor</span>
<span class="n">some_tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Find out details about it</span>
<span class="nb">print</span><span class="p">(</span><span class="n">some_tensor</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Shape of tensor: </span><span class="si">{</span><span class="n">some_tensor</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datatype of tensor: </span><span class="si">{</span><span class="n">some_tensor</span><span class="o">.</span><span class="n">dtype</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Device tensor is stored on: </span><span class="si">{</span><span class="n">some_tensor</span><span class="o">.</span><span class="n">device</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># will default to CPU</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[0.4688, 0.0055, 0.8551, 0.0646],
        [0.6538, 0.5157, 0.4071, 0.2109],
        [0.9960, 0.3061, 0.9369, 0.7008]])
Shape of tensor: torch.Size([3, 4])
Datatype of tensor: torch.float32
Device tensor is stored on: cpu
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> When you run into issues in PyTorch, it’s very often one to do with one of the three attributes above. So when the error messages show up, sing yourself a little song called “what, what, where”:</p>
</div></blockquote>
<ul class="simple">
<li><p>“<em>what shape are my tensors? what datatype are they and where are they stored? what shape, what datatype, where where where</em>”</p></li>
</ul>
</section>
<section id="manipulating-tensors-tensor-operations">
<h2>Manipulating tensors (tensor operations)<a class="headerlink" href="#manipulating-tensors-tensor-operations" title="Link to this heading">#</a></h2>
<p>In deep learning, data (images, text, video, audio, protein structures, etc) gets represented as tensors. And tensors are manipulated by doing following operations</p>
<ul class="simple">
<li><p>Addition</p></li>
<li><p>Substraction</p></li>
<li><p>Multiplication (element-wise)</p></li>
<li><p>Division</p></li>
<li><p>Matrix multiplication</p></li>
</ul>
<p>These are the basic building blocks of neural networks.</p>
<p>Stacking these building blocks in the right way, you can create the most sophisticated of neural networks.</p>
<section id="basic-operations">
<h3>Basic operations<a class="headerlink" href="#basic-operations" title="Link to this heading">#</a></h3>
<p>Let’s start with a few of the fundamental operations, addition (<code class="docutils literal notranslate"><span class="pre">+</span></code>), subtraction (<code class="docutils literal notranslate"><span class="pre">-</span></code>), mutliplication (<code class="docutils literal notranslate"><span class="pre">*</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor of values and add a number to it</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">tensor</span> <span class="o">+</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([11, 12, 13])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Multiply it by 10</span>
<span class="n">tensor</span> <span class="o">*</span> <span class="mi">10</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([10, 20, 30])
</pre></div>
</div>
</div>
</div>
<p>Notice how the tensor values above didn’t end up being <code class="docutils literal notranslate"><span class="pre">tensor([110,</span> <span class="pre">120,</span> <span class="pre">130])</span></code>, this is because the values inside the tensor don’t change unless they’re reassigned.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tensors don&#39;t change unless reassigned</span>
<span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3])
</pre></div>
</div>
</div>
</div>
<p>Let’s subtract a number and this time we’ll reassign the <code class="docutils literal notranslate"><span class="pre">tensor</span></code> variable.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Subtract and reassign</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span> <span class="o">-</span> <span class="mi">10</span>
<span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([-9, -8, -7])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add and reassign</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span> <span class="o">+</span> <span class="mi">10</span>
<span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3])
</pre></div>
</div>
</div>
</div>
<p>PyTorch also has a bunch of built-in functions like <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.mul.html#torch.mul"><code class="docutils literal notranslate"><span class="pre">torch.mul()</span></code></a> (short for multiplication) and <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.add.html"><code class="docutils literal notranslate"><span class="pre">torch.add()</span></code></a> to perform basic operations.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Can also use torch functions</span>
<span class="n">torch</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([10, 20, 30])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original tensor is still unchanged </span>
<span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3])
</pre></div>
</div>
</div>
</div>
<p>However, it’s more common to use the operator symbols like <code class="docutils literal notranslate"><span class="pre">*</span></code> instead of <code class="docutils literal notranslate"><span class="pre">torch.mul()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Element-wise multiplication (each element multiplies its equivalent, index 0-&gt;0, 1-&gt;1, 2-&gt;2)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">tensor</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Equals:&quot;</span><span class="p">,</span> <span class="n">tensor</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3]) * tensor([1, 2, 3])
Equals: tensor([1, 4, 9])
</pre></div>
</div>
</div>
</div>
</section>
<section id="matrix-multiplication-is-all-you-need">
<h3>Matrix multiplication (is all you need)<a class="headerlink" href="#matrix-multiplication-is-all-you-need" title="Link to this heading">#</a></h3>
<p>One of the most common operations in machine learning and deep learning algorithms (like neural networks) is <a class="reference external" href="https://www.mathsisfun.com/algebra/matrix-multiplying.html">matrix multiplication</a>.</p>
<p>PyTorch implements matrix multiplication functionality in the <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.matmul.html"><code class="docutils literal notranslate"><span class="pre">torch.matmul()</span></code></a> method.</p>
<p>The main two rules for matrix multiplication to remember are:</p>
<ol class="arabic simple">
<li><p>The <strong>inner dimensions</strong> must match:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">2)</span> <span class="pre">&#64;</span> <span class="pre">(3,</span> <span class="pre">2)</span></code> won’t work</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3)</span> <span class="pre">&#64;</span> <span class="pre">(3,</span> <span class="pre">2)</span></code> will work</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">2)</span> <span class="pre">&#64;</span> <span class="pre">(2,</span> <span class="pre">3)</span></code> will work</p></li>
</ul>
<ol class="arabic simple" start="2">
<li><p>The resulting matrix has the shape of the <strong>outer dimensions</strong>:</p></li>
</ol>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">3)</span> <span class="pre">&#64;</span> <span class="pre">(3,</span> <span class="pre">2)</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">(2,</span> <span class="pre">2)</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">2)</span> <span class="pre">&#64;</span> <span class="pre">(2,</span> <span class="pre">3)</span></code> -&gt; <code class="docutils literal notranslate"><span class="pre">(3,</span> <span class="pre">3)</span></code></p></li>
</ul>
<blockquote>
<div><p><strong>Note:</strong> “<code class="docutils literal notranslate"><span class="pre">&#64;</span></code>” in Python is the symbol for matrix multiplication.</p>
</div></blockquote>
<blockquote>
<div><p><strong>Resource:</strong> You can see all of the rules for matrix multiplication using <code class="docutils literal notranslate"><span class="pre">torch.matmul()</span></code> <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.matmul.html">in the PyTorch documentation</a>.</p>
</div></blockquote>
<p>Let’s create a tensor and perform element-wise multiplication and matrix multiplication on it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>
<span class="n">tensor</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.Size([3])
</pre></div>
</div>
</div>
</div>
<p>The difference between element-wise multiplication and matrix multiplication is the addition of values.</p>
<p>For our <code class="docutils literal notranslate"><span class="pre">tensor</span></code> variable with values <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">2,</span> <span class="pre">3]</span></code>:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Operation</p></th>
<th class="head"><p>Calculation</p></th>
<th class="head"><p>Code</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>Element-wise multiplication</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1*1,</span> <span class="pre">2*2,</span> <span class="pre">3*3]</span></code> = <code class="docutils literal notranslate"><span class="pre">[1,</span> <span class="pre">4,</span> <span class="pre">9]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensor</span> <span class="pre">*</span> <span class="pre">tensor</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><strong>Matrix multiplication</strong></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">[1*1</span> <span class="pre">+</span> <span class="pre">2*2</span> <span class="pre">+</span> <span class="pre">3*3]</span></code> = <code class="docutils literal notranslate"><span class="pre">[14]</span></code></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">tensor.matmul(tensor)</span></code></p></td>
</tr>
</tbody>
</table>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Element-wise matrix multiplication</span>
<span class="n">tensor</span> <span class="o">*</span> <span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 4, 9])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Matrix multiplication</span>
<span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Can also use the &quot;@&quot; symbol for matrix multiplication, though not recommended</span>
<span class="n">tensor</span> <span class="o">@</span> <span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(14)
</pre></div>
</div>
</div>
</div>
<p>You can do matrix multiplication by hand but it’s not recommended.</p>
<p>The in-built <code class="docutils literal notranslate"><span class="pre">torch.matmul()</span></code> method is faster.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="c1"># Matrix multiplication by hand </span>
<span class="c1"># (avoid doing operations with for loops at all cost, they are computationally expensive)</span>
<span class="n">value</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">tensor</span><span class="p">)):</span>
  <span class="n">value</span> <span class="o">+=</span> <span class="n">tensor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">tensor</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
<span class="n">value</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 773 µs, sys: 0 ns, total: 773 µs
Wall time: 499 µs
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(14)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%%time</span>
<span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tensor</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>CPU times: user 146 µs, sys: 83 µs, total: 229 µs
Wall time: 171 µs
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor(14)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section id="one-of-the-most-common-errors-in-deep-learning-shape-errors">
<h2>One of the most common errors in deep learning (shape errors)<a class="headerlink" href="#one-of-the-most-common-errors-in-deep-learning-shape-errors" title="Link to this heading">#</a></h2>
<p>Because much of deep learning is multiplying and performing operations on matrices and matrices have a strict rule about what shapes and sizes can be combined, one of the most common errors you’ll run into in deep learning is shape mismatches.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Shapes need to be in the right way  </span>
<span class="n">tensor_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">tensor_B</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
                         <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> 
                         <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tensor_A</span><span class="p">,</span> <span class="n">tensor_B</span><span class="p">)</span> <span class="c1"># (this will error)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="nn">/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb Cell 75</span> in <span class="ni">&lt;cell line: 10&gt;</span><span class="nt">()</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=1&#39;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="n">tensor_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=2&#39;</span><span class="o">&gt;</span><span class="mi">3</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>                          <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=3&#39;</span><span class="o">&gt;</span><span class="mi">4</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>                          <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=5&#39;</span><span class="o">&gt;</span><span class="mi">6</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="n">tensor_B</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">10</span><span class="p">],</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=6&#39;</span><span class="o">&gt;</span><span class="mi">7</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>                          <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> 
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=7&#39;</span><span class="o">&gt;</span><span class="mi">8</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>                          <span class="p">[</span><span class="mi">9</span><span class="p">,</span> <span class="mi">12</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="o">---&gt;</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y134sdnNjb2RlLXJlbW90ZQ%3D%3D?line=9&#39;</span><span class="o">&gt;</span><span class="mi">10</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tensor_A</span><span class="p">,</span> <span class="n">tensor_B</span><span class="p">)</span>

<span class="ne">RuntimeError</span>: mat1 and mat2 shapes cannot be multiplied (3x2 and 3x2)
</pre></div>
</div>
</div>
</div>
<p>We can make matrix multiplication work between <code class="docutils literal notranslate"><span class="pre">tensor_A</span></code> and <code class="docutils literal notranslate"><span class="pre">tensor_B</span></code> by making their inner dimensions match.</p>
<p>One of the ways to do this is with a <strong>transpose</strong> (switch the dimensions of a given tensor).</p>
<p>You can perform transposes in PyTorch using either:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">torch.transpose(input,</span> <span class="pre">dim0,</span> <span class="pre">dim1)</span></code> - where <code class="docutils literal notranslate"><span class="pre">input</span></code> is the desired tensor to transpose and <code class="docutils literal notranslate"><span class="pre">dim0</span></code> and <code class="docutils literal notranslate"><span class="pre">dim1</span></code> are the dimensions to be swapped.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">tensor.T</span></code> - where <code class="docutils literal notranslate"><span class="pre">tensor</span></code> is the desired tensor to transpose.</p></li>
</ul>
<p>Let’s try the latter.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># View tensor_A and tensor_B</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor_A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor_B</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[1., 2.],
        [3., 4.],
        [5., 6.]])
tensor([[ 7., 10.],
        [ 8., 11.],
        [ 9., 12.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># View tensor_A and tensor_B.T</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor_A</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor_B</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[1., 2.],
        [3., 4.],
        [5., 6.]])
tensor([[ 7.,  8.,  9.],
        [10., 11., 12.]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># The operation works when tensor_B is transposed</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Original shapes: tensor_A = </span><span class="si">{</span><span class="n">tensor_A</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">, tensor_B = </span><span class="si">{</span><span class="n">tensor_B</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New shapes: tensor_A = </span><span class="si">{</span><span class="n">tensor_A</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> (same as above), tensor_B.T = </span><span class="si">{</span><span class="n">tensor_B</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Multiplying: </span><span class="si">{</span><span class="n">tensor_A</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> * </span><span class="si">{</span><span class="n">tensor_B</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2"> &lt;- inner dimensions match</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">tensor_A</span><span class="p">,</span> <span class="n">tensor_B</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Output shape: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Original shapes: tensor_A = torch.Size([3, 2]), tensor_B = torch.Size([3, 2])

New shapes: tensor_A = torch.Size([3, 2]) (same as above), tensor_B.T = torch.Size([2, 3])

Multiplying: torch.Size([3, 2]) * torch.Size([2, 3]) &lt;- inner dimensions match

Output:

tensor([[ 27.,  30.,  33.],
        [ 61.,  68.,  75.],
        [ 95., 106., 117.]])

Output shape: torch.Size([3, 3])
</pre></div>
</div>
</div>
</div>
<p>You can also use <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.mm.html"><code class="docutils literal notranslate"><span class="pre">torch.mm()</span></code></a> which is a short for <code class="docutils literal notranslate"><span class="pre">torch.matmul()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># torch.mm is a shortcut for matmul</span>
<span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">tensor_A</span><span class="p">,</span> <span class="n">tensor_B</span><span class="o">.</span><span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[ 27.,  30.,  33.],
        [ 61.,  68.,  75.],
        [ 95., 106., 117.]])
</pre></div>
</div>
</div>
</div>
<p>Without the transpose, the rules of matrix mulitplication aren’t fulfilled and we get an error like above.</p>
<p><img alt="visual demo of matrix multiplication" src="../../../_images/00-matrix-multiply-crop.gif" /></p>
<p>You can create your own matrix multiplication visuals like this at <a class="reference external" href="http://matrixmultiplication.xyz/">http://matrixmultiplication.xyz/</a>.</p>
<blockquote>
<div><p><strong>Note:</strong> A matrix multiplication like this is also referred to as the <a class="reference external" href="https://www.mathsisfun.com/algebra/vectors-dot-product.html"><strong>dot product</strong></a> of two matrices.</p>
</div></blockquote>
<p>Neural networks are full of matrix multiplications and dot products.</p>
<p>The <a class="reference external" href="https://pytorch.org/docs/1.9.1/generated/torch.nn.Linear.html"><code class="docutils literal notranslate"><span class="pre">torch.nn.Linear()</span></code></a> module (we’ll see this in action later on), also known as a feed-forward layer or fully connected layer, implements a matrix multiplication between an input <code class="docutils literal notranslate"><span class="pre">x</span></code> and a weights matrix <code class="docutils literal notranslate"><span class="pre">A</span></code>.</p>
<div class="math notranslate nohighlight">
\[
y = x\cdot{A^T} + b
\]</div>
<p>Where:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">x</span></code> is the input to the layer (deep learning is a stack of layers like <code class="docutils literal notranslate"><span class="pre">torch.nn.Linear()</span></code> and others on top of each other).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">A</span></code> is the weights matrix created by the layer, this starts out as random numbers that get adjusted as a neural network learns to better represent patterns in the data (notice the “<code class="docutils literal notranslate"><span class="pre">T</span></code>”, that’s because the weights matrix gets transposed).</p>
<ul>
<li><p><strong>Note:</strong> You might also often see <code class="docutils literal notranslate"><span class="pre">W</span></code> or another letter like <code class="docutils literal notranslate"><span class="pre">X</span></code> used to showcase the weights matrix.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">b</span></code> is the bias term used to slightly offset the weights and inputs.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">y</span></code> is the output (a manipulation of the input in the hopes to discover patterns in it).</p></li>
</ul>
<p>This is a linear function (you may have seen something like <span class="math notranslate nohighlight">\(y = mx+b\)</span> in high school or elsewhere), and can be used to draw a straight line!</p>
<p>Let’s play around with a linear layer.</p>
<p>Try changing the values of <code class="docutils literal notranslate"><span class="pre">in_features</span></code> and <code class="docutils literal notranslate"><span class="pre">out_features</span></code> below and see what happens.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Since the linear layer starts with a random weights matrix, let&#39;s make it reproducible (more on this later)</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="c1"># This uses matrix multiplication</span>
<span class="n">linear</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="n">in_features</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="c1"># in_features = matches inner dimension of input </span>
                         <span class="n">out_features</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span> <span class="c1"># out_features = describes outer value </span>
<span class="n">x</span> <span class="o">=</span> <span class="n">tensor_A</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">linear</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Input shape: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Output:</span><span class="se">\n</span><span class="si">{</span><span class="n">output</span><span class="si">}</span><span class="se">\n\n</span><span class="s2">Output shape: </span><span class="si">{</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Input shape: torch.Size([3, 2])

Output:
tensor([[2.2368, 1.2292, 0.4714, 0.3864, 0.1309, 0.9838],
        [4.4919, 2.1970, 0.4469, 0.5285, 0.3401, 2.4777],
        [6.7469, 3.1648, 0.4224, 0.6705, 0.5493, 3.9716]],
       grad_fn=&lt;AddmmBackward0&gt;)

Output shape: torch.Size([3, 6])
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Question:</strong> What happens if you change <code class="docutils literal notranslate"><span class="pre">in_features</span></code> from 2 to 3 above? Does it error? How could you change the shape of the input (<code class="docutils literal notranslate"><span class="pre">x</span></code>) to accomodate to the error? Hint: what did we have to do to <code class="docutils literal notranslate"><span class="pre">tensor_B</span></code> above?</p>
</div></blockquote>
<p>Matrix multiplication can be a confusing topic at first.</p>
<p>But after you’ve played around with it a few times and looked into some neural networks, you’ll notice it’s everywhere.</p>
<p>Matrix multiplication is all you need.</p>
<p><img alt="matrix multiplication is all you need" src="../../../_images/00_matrix_multiplication_is_all_you_need.jpeg" /></p>
<p><em>When you start digging into neural network layers and building your own, you’ll find matrix multiplications everywhere. <strong>Source:</strong> <a class="reference external" href="https://marksaroufim.substack.com/p/working-class-deep-learner">https://marksaroufim.substack.com/p/working-class-deep-learner</a></em></p>
<section id="finding-the-min-max-mean-sum-etc-aggregation">
<h3>Finding the min, max, mean, sum, etc (aggregation)<a class="headerlink" href="#finding-the-min-max-mean-sum-etc-aggregation" title="Link to this heading">#</a></h3>
<p>First we’ll create a tensor and then find the max, min, mean and sum of it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([ 0, 10, 20, 30, 40, 50, 60, 70, 80, 90])
</pre></div>
</div>
</div>
</div>
<p>Now let’s perform some aggregation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Minimum: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">min</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Maximum: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">max</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># print(f&quot;Mean: {x.mean()}&quot;) # this will error</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> <span class="c1"># won&#39;t work without float datatype</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sum: </span><span class="si">{</span><span class="n">x</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Minimum: 0
Maximum: 90
Mean: 45.0
Sum: 450
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> You may find some methods such as <code class="docutils literal notranslate"><span class="pre">torch.mean()</span></code> require tensors to be in <code class="docutils literal notranslate"><span class="pre">torch.float32</span></code> (the most common) or another specific datatype, otherwise the operation will fail.</p>
</div></blockquote>
<p>You can also do the same as above with <code class="docutils literal notranslate"><span class="pre">torch</span></code> methods.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">torch</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float32</span><span class="p">)),</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor(90), tensor(0), tensor(45.), tensor(450))
</pre></div>
</div>
</div>
</div>
</section>
<section id="positional-min-max">
<h3>Positional min/max<a class="headerlink" href="#positional-min-max" title="Link to this heading">#</a></h3>
<p>You can also find the index of a tensor where the max or minimum occurs with <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.argmax.html"><code class="docutils literal notranslate"><span class="pre">torch.argmax()</span></code></a> and <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.argmin.html"><code class="docutils literal notranslate"><span class="pre">torch.argmin()</span></code></a> respectively.</p>
<p>This is helpful incase you just want the position where the highest (or lowest) value is and not the actual value itself (we’ll see this in a later section when using the <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.nn.Softmax.html">softmax activation function</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor: </span><span class="si">{</span><span class="n">tensor</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Returns index of max and min values</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index where max value occurs: </span><span class="si">{</span><span class="n">tensor</span><span class="o">.</span><span class="n">argmax</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Index where min value occurs: </span><span class="si">{</span><span class="n">tensor</span><span class="o">.</span><span class="n">argmin</span><span class="p">()</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensor: tensor([10, 20, 30, 40, 50, 60, 70, 80, 90])
Index where max value occurs: 8
Index where min value occurs: 0
</pre></div>
</div>
</div>
</div>
</section>
<section id="change-tensor-datatype">
<h3>Change tensor datatype<a class="headerlink" href="#change-tensor-datatype" title="Link to this heading">#</a></h3>
<p>Another common issue with deep learning operations is having your tensors in different datatypes.</p>
<p>If one tensor is in <code class="docutils literal notranslate"><span class="pre">torch.float64</span></code> and another is in <code class="docutils literal notranslate"><span class="pre">torch.float32</span></code>, you might run into some errors.</p>
<p>You can change the datatypes of tensors using <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.type.html"><code class="docutils literal notranslate"><span class="pre">torch.Tensor.type(dtype=None)</span></code></a> where the <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameter is the datatype you’d like to use.</p>
<p>First we’ll create a tensor and check it’s datatype (the default is <code class="docutils literal notranslate"><span class="pre">torch.float32</span></code>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor and check its datatype</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.</span><span class="p">,</span> <span class="mf">100.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">)</span>
<span class="n">tensor</span><span class="o">.</span><span class="n">dtype</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>torch.float32
</pre></div>
</div>
</div>
</div>
<p>Now we’ll create another tensor the same as before but change its datatype to <code class="docutils literal notranslate"><span class="pre">torch.float16</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a float16 tensor</span>
<span class="n">tensor_float16</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="n">tensor_float16</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([10., 20., 30., 40., 50., 60., 70., 80., 90.], dtype=torch.float16)
</pre></div>
</div>
</div>
</div>
<p>And we can do something similar to make a <code class="docutils literal notranslate"><span class="pre">torch.int8</span></code> tensor.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a int8 tensor</span>
<span class="n">tensor_int8</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">type</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">int8</span><span class="p">)</span>
<span class="n">tensor_int8</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([10, 20, 30, 40, 50, 60, 70, 80, 90], dtype=torch.int8)
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> Different datatypes can be confusing to begin with. But think of it like this, the lower the number (e.g. 32, 16, 8), the less precise a computer stores the value. And with a lower amount of storage, this generally results in faster computation and a smaller overall model. Mobile-based neural networks often operate with 8-bit integers, smaller and faster to run but less accurate than their float32 counterparts. For more on this, I’d read up about <a class="reference external" href="https://en.wikipedia.org/wiki/Precision_(computer_science)">precision in computing</a>.</p>
</div></blockquote>
</section>
<section id="reshaping-stacking-squeezing-and-unsqueezing">
<h3>Reshaping, stacking, squeezing and unsqueezing<a class="headerlink" href="#reshaping-stacking-squeezing-and-unsqueezing" title="Link to this heading">#</a></h3>
<p>Often times you’ll want to reshape or change the dimensions of your tensors without actually changing the values inside them.</p>
<p>To do so, some popular methods are:</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p>Method</p></th>
<th class="head"><p>One-line description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.reshape.html#torch.reshape"><code class="docutils literal notranslate"><span class="pre">torch.reshape(input,</span> <span class="pre">shape)</span></code></a></p></td>
<td><p>Reshapes <code class="docutils literal notranslate"><span class="pre">input</span></code> to <code class="docutils literal notranslate"><span class="pre">shape</span></code> (if compatible), can also use <code class="docutils literal notranslate"><span class="pre">torch.Tensor.reshape()</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.view.html"><code class="docutils literal notranslate"><span class="pre">Tensor.view(shape)</span></code></a></p></td>
<td><p>Returns a view of the original tensor in a different <code class="docutils literal notranslate"><span class="pre">shape</span></code> but shares the same data as the original tensor.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://pytorch.org/docs/1.9.1/generated/torch.stack.html"><code class="docutils literal notranslate"><span class="pre">torch.stack(tensors,</span> <span class="pre">dim=0)</span></code></a></p></td>
<td><p>Concatenates a sequence of <code class="docutils literal notranslate"><span class="pre">tensors</span></code> along a new dimension (<code class="docutils literal notranslate"><span class="pre">dim</span></code>), all <code class="docutils literal notranslate"><span class="pre">tensors</span></code> must be same size.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.squeeze.html"><code class="docutils literal notranslate"><span class="pre">torch.squeeze(input)</span></code></a></p></td>
<td><p>Squeezes <code class="docutils literal notranslate"><span class="pre">input</span></code> to remove all the dimenions with value <code class="docutils literal notranslate"><span class="pre">1</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://pytorch.org/docs/1.9.1/generated/torch.unsqueeze.html"><code class="docutils literal notranslate"><span class="pre">torch.unsqueeze(input,</span> <span class="pre">dim)</span></code></a></p></td>
<td><p>Returns <code class="docutils literal notranslate"><span class="pre">input</span></code> with a dimension value of <code class="docutils literal notranslate"><span class="pre">1</span></code> added at <code class="docutils literal notranslate"><span class="pre">dim</span></code>.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.permute.html"><code class="docutils literal notranslate"><span class="pre">torch.permute(input,</span> <span class="pre">dims)</span></code></a></p></td>
<td><p>Returns a <em>view</em> of the original <code class="docutils literal notranslate"><span class="pre">input</span></code> with its dimensions permuted (rearranged) to <code class="docutils literal notranslate"><span class="pre">dims</span></code>.</p></td>
</tr>
</tbody>
</table>
</div>
<p>Deep learning models (neural networks) are all about manipulating tensors in some way. And because of the rules of matrix multiplication, if you’ve got shape mismatches, you’ll run into errors. These methods help you make sure the right elements of your tensors are mixing with the right elements of other tensors.</p>
<p>Let’s try them out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">8.</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([1., 2., 3., 4., 5., 6., 7.]), torch.Size([7]))
</pre></div>
</div>
</div>
</div>
<p>Now let’s add an extra dimension with <code class="docutils literal notranslate"><span class="pre">torch.reshape()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Add an extra dimension</span>
<span class="n">x_reshaped</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">x_reshaped</span><span class="p">,</span> <span class="n">x_reshaped</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[1., 2., 3., 4., 5., 6., 7.]]), torch.Size([1, 7]))
</pre></div>
</div>
</div>
</div>
<p>We can also change the view with <code class="docutils literal notranslate"><span class="pre">torch.view()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change view (keeps same data as original but changes view)</span>
<span class="c1"># See more: https://stackoverflow.com/a/54507446/7900723</span>
<span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">7</span><span class="p">)</span>
<span class="n">z</span><span class="p">,</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[1., 2., 3., 4., 5., 6., 7.]]), torch.Size([1, 7]))
</pre></div>
</div>
</div>
</div>
<p>Remember though, changing the view of a tensor with <code class="docutils literal notranslate"><span class="pre">torch.view()</span></code> really only creates a new view of the <em>same</em> tensor.</p>
<p>So changing the view changes the original tensor too.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Changing z changes x</span>
<span class="n">z</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">z</span><span class="p">,</span> <span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[5., 2., 3., 4., 5., 6., 7.]]), tensor([5., 2., 3., 4., 5., 6., 7.]))
</pre></div>
</div>
</div>
</div>
<p>If we wanted to stack our new tensor on top of itself five times, we could do so with <code class="docutils literal notranslate"><span class="pre">torch.stack()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stack tensors on top of each other</span>
<span class="n">x_stacked</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span> <span class="c1"># try changing dim to dim=1 and see what happens</span>
<span class="n">x_stacked</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[5., 2., 3., 4., 5., 6., 7.],
        [5., 2., 3., 4., 5., 6., 7.],
        [5., 2., 3., 4., 5., 6., 7.],
        [5., 2., 3., 4., 5., 6., 7.]])
</pre></div>
</div>
</div>
</div>
<p>How about removing all single dimensions from a tensor?</p>
<p>To do so you can use <code class="docutils literal notranslate"><span class="pre">torch.squeeze()</span></code></p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Previous tensor: </span><span class="si">{</span><span class="n">x_reshaped</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Previous shape: </span><span class="si">{</span><span class="n">x_reshaped</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Remove extra dimension from x_reshaped</span>
<span class="n">x_squeezed</span> <span class="o">=</span> <span class="n">x_reshaped</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">New tensor: </span><span class="si">{</span><span class="n">x_squeezed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New shape: </span><span class="si">{</span><span class="n">x_squeezed</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Previous tensor: tensor([[5., 2., 3., 4., 5., 6., 7.]])
Previous shape: torch.Size([1, 7])

New tensor: tensor([5., 2., 3., 4., 5., 6., 7.])
New shape: torch.Size([7])
</pre></div>
</div>
</div>
</div>
<p>And to do the reverse of <code class="docutils literal notranslate"><span class="pre">torch.squeeze()</span></code> you can use <code class="docutils literal notranslate"><span class="pre">torch.unsqueeze()</span></code> to add a dimension value of 1 at a specific index.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Previous tensor: </span><span class="si">{</span><span class="n">x_squeezed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Previous shape: </span><span class="si">{</span><span class="n">x_squeezed</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1">## Add an extra dimension with unsqueeze</span>
<span class="n">x_unsqueezed</span> <span class="o">=</span> <span class="n">x_squeezed</span><span class="o">.</span><span class="n">unsqueeze</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">New tensor: </span><span class="si">{</span><span class="n">x_unsqueezed</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New shape: </span><span class="si">{</span><span class="n">x_unsqueezed</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Previous tensor: tensor([5., 2., 3., 4., 5., 6., 7.])
Previous shape: torch.Size([7])

New tensor: tensor([[5., 2., 3., 4., 5., 6., 7.]])
New shape: torch.Size([1, 7])
</pre></div>
</div>
</div>
</div>
<p>You can also rearrange the order of axes values with <code class="docutils literal notranslate"><span class="pre">torch.permute(input,</span> <span class="pre">dims)</span></code>, where the <code class="docutils literal notranslate"><span class="pre">input</span></code> gets turned into a <em>view</em> with new <code class="docutils literal notranslate"><span class="pre">dims</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create tensor with specific shape</span>
<span class="n">x_original</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">224</span><span class="p">,</span> <span class="mi">224</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<span class="c1"># Permute the original tensor to rearrange the axis order</span>
<span class="n">x_permuted</span> <span class="o">=</span> <span class="n">x_original</span><span class="o">.</span><span class="n">permute</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="c1"># shifts axis 0-&gt;1, 1-&gt;2, 2-&gt;0</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Previous shape: </span><span class="si">{</span><span class="n">x_original</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;New shape: </span><span class="si">{</span><span class="n">x_permuted</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Previous shape: torch.Size([224, 224, 3])
New shape: torch.Size([3, 224, 224])
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note</strong>: Because permuting returns a <em>view</em> (shares the same data as the original), the values in the permuted tensor will be the same as the original tensor and if you change the values in the view, it will change the values of the original.</p>
</div></blockquote>
</section>
</section>
<section id="indexing-selecting-data-from-tensors">
<h2>Indexing (selecting data from tensors)<a class="headerlink" href="#indexing-selecting-data-from-tensors" title="Link to this heading">#</a></h2>
<p>Sometimes you’ll want to select specific data from tensors (for example, only the first column or second row).</p>
<p>To do so, you can use indexing.</p>
<p>If you’ve ever done indexing on Python lists or NumPy arrays, indexing in PyTorch with tensors is very similar.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create a tensor </span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([[[1, 2, 3],
          [4, 5, 6],
          [7, 8, 9]]]),
 torch.Size([1, 3, 3]))
</pre></div>
</div>
</div>
</div>
<p>Indexing values goes outer dimension -&gt; inner dimension (check out the square brackets).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Let&#39;s index bracket by bracket</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;First square bracket:</span><span class="se">\n</span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Second square bracket: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span> 
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Third square bracket: </span><span class="si">{</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>First square bracket:
tensor([[1, 2, 3],
        [4, 5, 6],
        [7, 8, 9]])
Second square bracket: tensor([1, 2, 3])
Third square bracket: 1
</pre></div>
</div>
</div>
</div>
<p>You can also use <code class="docutils literal notranslate"><span class="pre">:</span></code> to specify “all values in this dimension” and then use a comma (<code class="docutils literal notranslate"><span class="pre">,</span></code>) to add another dimension.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get all values of 0th dimension and the 0 index of 1st dimension</span>
<span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[1, 2, 3]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get all values of 0th &amp; 1st dimensions but only index 1 of 2nd dimension</span>
<span class="n">x</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[2, 5, 8]])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get all values of the 0 dimension but only the 1 index value of the 1st and 2nd dimension</span>
<span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([5])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get index 0 of 0th and 1st dimension and all values of 2nd dimension </span>
<span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="p">:]</span> <span class="c1"># same as x[0][0]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3])
</pre></div>
</div>
</div>
</div>
<p>Indexing can be quite confusing to begin with, especially with larger tensors But with a bit of practice and following the data explorer’s motto (<em><strong>visualize, visualize, visualize</strong></em>), you’ll start to get the hang of it.</p>
</section>
<section id="pytorch-tensors-numpy">
<h2>PyTorch tensors &amp; NumPy<a class="headerlink" href="#pytorch-tensors-numpy" title="Link to this heading">#</a></h2>
<p>Since NumPy is a popular Python numerical computing library, PyTorch has functionality to interact with it nicely.</p>
<p>The two main methods you’ll want to use for NumPy to PyTorch (and back again) are:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.from_numpy.html"><code class="docutils literal notranslate"><span class="pre">torch.from_numpy(ndarray)</span></code></a> - NumPy array -&gt; PyTorch tensor.</p></li>
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.numpy.html"><code class="docutils literal notranslate"><span class="pre">torch.Tensor.numpy()</span></code></a> - PyTorch tensor -&gt; NumPy array.</p></li>
</ul>
<p>Let’s try them out.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># NumPy array to tensor</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">8.0</span><span class="p">)</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">array</span><span class="p">)</span>
<span class="n">array</span><span class="p">,</span> <span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([1., 2., 3., 4., 5., 6., 7.]),
 tensor([1., 2., 3., 4., 5., 6., 7.], dtype=torch.float64))
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Note:</strong> By default, NumPy arrays are created with the datatype <code class="docutils literal notranslate"><span class="pre">float64</span></code> and if you convert it to a PyTorch tensor, it’ll keep the same datatype (as above).</p>
<p>However, many PyTorch calculations default to using <code class="docutils literal notranslate"><span class="pre">float32</span></code>.</p>
<p>So if you want to convert your NumPy array (float64) -&gt; PyTorch tensor (float64) -&gt; PyTorch tensor (float32), you can use <code class="docutils literal notranslate"><span class="pre">tensor</span> <span class="pre">=</span> <span class="pre">torch.from_numpy(array).type(torch.float32)</span></code>.</p>
</div></blockquote>
<p>Because we reassigned <code class="docutils literal notranslate"><span class="pre">tensor</span></code> above, if you change the tensor, the array stays the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change the array, keep the tensor</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">array</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">array</span><span class="p">,</span> <span class="n">tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([2., 3., 4., 5., 6., 7., 8.]),
 tensor([1., 2., 3., 4., 5., 6., 7.], dtype=torch.float64))
</pre></div>
</div>
</div>
</div>
<p>And if you want to go from PyTorch tensor to NumPy array, you can call <code class="docutils literal notranslate"><span class="pre">tensor.numpy()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tensor to NumPy array</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span> <span class="c1"># create a tensor of ones with dtype=float32</span>
<span class="n">numpy_tensor</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span> <span class="c1"># will be dtype=float32 unless changed</span>
<span class="n">tensor</span><span class="p">,</span> <span class="n">numpy_tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([1., 1., 1., 1., 1., 1., 1.]),
 array([1., 1., 1., 1., 1., 1., 1.], dtype=float32))
</pre></div>
</div>
</div>
</div>
<p>And the same rule applies as above, if you change the original <code class="docutils literal notranslate"><span class="pre">tensor</span></code>, the new <code class="docutils literal notranslate"><span class="pre">numpy_tensor</span></code> stays the same.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Change the tensor, keep the array the same</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">tensor</span> <span class="o">+</span> <span class="mi">1</span>
<span class="n">tensor</span><span class="p">,</span> <span class="n">numpy_tensor</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(tensor([2., 2., 2., 2., 2., 2., 2.]),
 array([1., 1., 1., 1., 1., 1., 1.], dtype=float32))
</pre></div>
</div>
</div>
</div>
</section>
<section id="significance-of-random-seeding">
<h2>Significance of random seeding<a class="headerlink" href="#significance-of-random-seeding" title="Link to this heading">#</a></h2>
<p>You might have seen in earlier code, we used <code class="docutils literal notranslate"><span class="pre">random.manual_seed(42)</span></code> method. Let’s understand why do we need it.</p>
<p>As you learn more about neural networks and machine learning, you’ll start to discover how much randomness plays a part.</p>
<p>Neural networks start with random numbers to describe patterns in data (these numbers are poor descriptions) and try to improve those random numbers using tensor operations to better describe patterns in data.</p>
<p>In short:</p>
<p><code class="docutils literal notranslate"><span class="pre">start</span> <span class="pre">with</span> <span class="pre">random</span> <span class="pre">numbers</span> <span class="pre">-&gt;</span> <span class="pre">tensor</span> <span class="pre">operations</span> <span class="pre">-&gt;</span> <span class="pre">try</span> <span class="pre">to</span> <span class="pre">make</span> <span class="pre">better</span> <span class="pre">(again</span> <span class="pre">and</span> <span class="pre">again</span> <span class="pre">and</span> <span class="pre">again)</span></code></p>
<p>But, you want <code class="docutils literal notranslate"><span class="pre">Reproducibility</span></code> of your code everytime you run it (for repeatable experiments), because random is so random, that every time you run, random will generate different numbers. Which means you wont have a reproducibility,</p>
<p>For example, you create an algorithm capable of achieving X performance.</p>
<p>And then your friend tries it out to verify you’re not crazy.</p>
<p>How could they do such a thing?</p>
<p>That’s where <strong>reproducibility</strong> comes in.</p>
<p>In other words, can you get the same (or very similar) results on your computer running the same code as I get on mine?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># Create two random tensors</span>
<span class="n">random_tensor_A</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
<span class="n">random_tensor_B</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor A:</span><span class="se">\n</span><span class="si">{</span><span class="n">random_tensor_A</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor B:</span><span class="se">\n</span><span class="si">{</span><span class="n">random_tensor_B</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Does Tensor A equal Tensor B? (anywhere)&quot;</span><span class="p">)</span>
<span class="n">random_tensor_A</span> <span class="o">==</span> <span class="n">random_tensor_B</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensor A:
tensor([[0.8016, 0.3649, 0.6286, 0.9663],
        [0.7687, 0.4566, 0.5745, 0.9200],
        [0.3230, 0.8613, 0.0919, 0.3102]])

Tensor B:
tensor([[0.9536, 0.6002, 0.0351, 0.6826],
        [0.3743, 0.5220, 0.1336, 0.9666],
        [0.9754, 0.8474, 0.8988, 0.1105]])

Does Tensor A equal Tensor B? (anywhere)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[False, False, False, False],
        [False, False, False, False],
        [False, False, False, False]])
</pre></div>
</div>
</div>
</div>
<p>Just as you might’ve expected, the tensors come out with different values.</p>
<p>But what if you wanted to created two random tensors with the <em>same</em> values.</p>
<p>As in, the tensors would still contain random values but they would be of the same flavour.</p>
<p>That’s where <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.manual_seed.html"><code class="docutils literal notranslate"><span class="pre">torch.manual_seed(seed)</span></code></a> comes in, where <code class="docutils literal notranslate"><span class="pre">seed</span></code> is an integer (like <code class="docutils literal notranslate"><span class="pre">42</span></code> but it could be anything) that flavours the randomness.</p>
<p>Let’s try it out by creating some more <em>flavoured</em> random tensors.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">torch</span>
<span class="kn">import</span> <span class="nn">random</span>

<span class="c1"># # Set the random seed</span>
<span class="n">RANDOM_SEED</span><span class="o">=</span><span class="mi">42</span> <span class="c1"># try changing this to different values and see what happens to the numbers below</span>
<span class="n">torch</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">RANDOM_SEED</span><span class="p">)</span> 
<span class="n">random_tensor_C</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Have to reset the seed every time a new rand() is called </span>
<span class="c1"># Without this, tensor_D would be different to tensor_C </span>
<span class="n">torch</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">manual_seed</span><span class="p">(</span><span class="n">seed</span><span class="o">=</span><span class="n">RANDOM_SEED</span><span class="p">)</span> <span class="c1"># try commenting this line out and seeing what happens</span>
<span class="n">random_tensor_D</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor C:</span><span class="se">\n</span><span class="si">{</span><span class="n">random_tensor_C</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tensor D:</span><span class="se">\n</span><span class="si">{</span><span class="n">random_tensor_D</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Does Tensor C equal Tensor D? (anywhere)&quot;</span><span class="p">)</span>
<span class="n">random_tensor_C</span> <span class="o">==</span> <span class="n">random_tensor_D</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tensor C:
tensor([[0.8823, 0.9150, 0.3829, 0.9593],
        [0.3904, 0.6009, 0.2566, 0.7936],
        [0.9408, 0.1332, 0.9346, 0.5936]])

Tensor D:
tensor([[0.8823, 0.9150, 0.3829, 0.9593],
        [0.3904, 0.6009, 0.2566, 0.7936],
        [0.9408, 0.1332, 0.9346, 0.5936]])

Does Tensor C equal Tensor D? (anywhere)
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([[True, True, True, True],
        [True, True, True, True],
        [True, True, True, True]])
</pre></div>
</div>
</div>
</div>
<blockquote>
<div><p><strong>Resource:</strong> What we’ve just covered only scratches the surface of reproducibility in PyTorch. For more, on reproducbility in general and random seeds, I’d checkout:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pytorch.org/docs/stable/notes/randomness.html">The PyTorch reproducibility documentation</a> (a good exericse would be to read through this for 10-minutes and even if you don’t understand it now, being aware of it is important).</p></li>
<li><p><a class="reference external" href="https://en.wikipedia.org/wiki/Random_seed">The Wikipedia random seed page</a> (this’ll give a good overview of random seeds and pseudorandomness in general).</p></li>
</ul>
</div></blockquote>
</section>
<section id="running-tensors-on-gpus-and-making-faster-computations">
<h2>Running tensors on GPUs (and making faster computations)<a class="headerlink" href="#running-tensors-on-gpus-and-making-faster-computations" title="Link to this heading">#</a></h2>
<p>Deep learning algorithms require a lot of numerical operations.</p>
<p>And by default these operations are often done on a CPU (computer processing unit).</p>
<p>However, there’s another common piece of hardware called a GPU (graphics processing unit), which is often much faster at performing the specific types of operations neural networks need (matrix multiplications) than CPUs.</p>
<p>Your computer might have one.</p>
<p>If so, you should look to use it whenever you can to train neural networks because chances are it’ll speed up the training time dramatically.</p>
<p>There are a few ways to first get access to a GPU and secondly get PyTorch to use the GPU.</p>
<blockquote>
<div><p><strong>Note:</strong> When I reference “GPU” throughout this course, I’m referencing a <a class="reference external" href="https://developer.nvidia.com/cuda-gpus">Nvidia GPU with CUDA</a> enabled (CUDA is a computing platform and API that helps allow GPUs be used for general purpose computing &amp; not just graphics) unless otherwise specified.</p>
</div></blockquote>
<section id="getting-a-gpu">
<h3>1. Getting a GPU<a class="headerlink" href="#getting-a-gpu" title="Link to this heading">#</a></h3>
<p>You may already know what’s going on when I say GPU. But if not, there are a few ways to get access to one.</p>
<div class="pst-scrollable-table-container"><table class="table">
<thead>
<tr class="row-odd"><th class="head"><p><strong>Method</strong></p></th>
<th class="head"><p><strong>Difficulty to setup</strong></p></th>
<th class="head"><p><strong>Pros</strong></p></th>
<th class="head"><p><strong>Cons</strong></p></th>
<th class="head"><p><strong>How to setup</strong></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Google Colab</p></td>
<td><p>Easy</p></td>
<td><p>Free to use, almost zero setup required, can share work with others as easy as a link</p></td>
<td><p>Doesn’t save your data outputs, limited compute, subject to timeouts</p></td>
<td><p><a class="reference external" href="https://colab.research.google.com/notebooks/gpu.ipynb">Follow the Google Colab Guide</a></p></td>
</tr>
<tr class="row-odd"><td><p>Use your own</p></td>
<td><p>Medium</p></td>
<td><p>Run everything locally on your own machine</p></td>
<td><p>GPUs aren’t free, require upfront cost</p></td>
<td><p>Follow the <a class="reference external" href="https://pytorch.org/get-started/locally/">PyTorch installation guidelines</a></p></td>
</tr>
<tr class="row-even"><td><p>Cloud computing (AWS, GCP, Azure)</p></td>
<td><p>Medium-Hard</p></td>
<td><p>Small upfront cost, access to almost infinite compute</p></td>
<td><p>Can get expensive if running continually, takes some time to setup right</p></td>
<td><p>Follow the <a class="reference external" href="https://pytorch.org/get-started/cloud-partners/">PyTorch installation guidelines</a></p></td>
</tr>
</tbody>
</table>
</div>
<p>To check if you’ve got access to a Nvidia GPU, you can run <code class="docutils literal notranslate"><span class="pre">!nvidia-smi</span></code> where the <code class="docutils literal notranslate"><span class="pre">!</span></code> (also called bang) means “run this on the command line”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>nvidia-smi
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Sat Jan 21 08:34:23 2023       
+-----------------------------------------------------------------------------+
| NVIDIA-SMI 515.48.07    Driver Version: 515.48.07    CUDA Version: 11.7     |
|-------------------------------+----------------------+----------------------+
| GPU  Name        Persistence-M| Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp  Perf  Pwr:Usage/Cap|         Memory-Usage | GPU-Util  Compute M. |
|                               |                      |               MIG M. |
|===============================+======================+======================|
|   0  NVIDIA TITAN RTX    On   | 00000000:01:00.0 Off |                  N/A |
| 40%   30C    P8     7W / 280W |    177MiB / 24576MiB |      0%      Default |
|                               |                      |                  N/A |
+-------------------------------+----------------------+----------------------+
                                                                               
+-----------------------------------------------------------------------------+
| Processes:                                                                  |
|  GPU   GI   CI        PID   Type   Process name                  GPU Memory |
|        ID   ID                                                   Usage      |
|=============================================================================|
|    0   N/A  N/A      1061      G   /usr/lib/xorg/Xorg                 53MiB |
|    0   N/A  N/A   2671131      G   /usr/lib/xorg/Xorg                 97MiB |
|    0   N/A  N/A   2671256      G   /usr/bin/gnome-shell                9MiB |
+-----------------------------------------------------------------------------+
</pre></div>
</div>
</div>
</div>
<p>If you don’t have a Nvidia GPU accessible, the above will output something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">NVIDIA</span><span class="o">-</span><span class="n">SMI</span> <span class="n">has</span> <span class="n">failed</span> <span class="n">because</span> <span class="n">it</span> <span class="n">couldn</span><span class="s1">&#39;t communicate with the NVIDIA driver. Make sure that the latest NVIDIA driver is installed and running.</span>
</pre></div>
</div>
<p>In that case, go back up and follow the install steps.</p>
<p>If you do have a GPU, the line above will output something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Wed</span> <span class="n">Jan</span> <span class="mi">19</span> <span class="mi">22</span><span class="p">:</span><span class="mi">09</span><span class="p">:</span><span class="mi">08</span> <span class="mi">2022</span>       
<span class="o">+-----------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">NVIDIA</span><span class="o">-</span><span class="n">SMI</span> <span class="mf">495.46</span>       <span class="n">Driver</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">460.32.03</span>    <span class="n">CUDA</span> <span class="n">Version</span><span class="p">:</span> <span class="mf">11.2</span>     <span class="o">|</span>
<span class="o">|-------------------------------+----------------------+----------------------+</span>
<span class="o">|</span> <span class="n">GPU</span>  <span class="n">Name</span>        <span class="n">Persistence</span><span class="o">-</span><span class="n">M</span><span class="o">|</span> <span class="n">Bus</span><span class="o">-</span><span class="n">Id</span>        <span class="n">Disp</span><span class="o">.</span><span class="n">A</span> <span class="o">|</span> <span class="n">Volatile</span> <span class="n">Uncorr</span><span class="o">.</span> <span class="n">ECC</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">Fan</span>  <span class="n">Temp</span>  <span class="n">Perf</span>  <span class="n">Pwr</span><span class="p">:</span><span class="n">Usage</span><span class="o">/</span><span class="n">Cap</span><span class="o">|</span>         <span class="n">Memory</span><span class="o">-</span><span class="n">Usage</span> <span class="o">|</span> <span class="n">GPU</span><span class="o">-</span><span class="n">Util</span>  <span class="n">Compute</span> <span class="n">M</span><span class="o">.</span> <span class="o">|</span>
<span class="o">|</span>                               <span class="o">|</span>                      <span class="o">|</span>               <span class="n">MIG</span> <span class="n">M</span><span class="o">.</span> <span class="o">|</span>
<span class="o">|===============================+======================+======================|</span>
<span class="o">|</span>   <span class="mi">0</span>  <span class="n">Tesla</span> <span class="n">P100</span><span class="o">-</span><span class="n">PCIE</span><span class="o">...</span>  <span class="n">Off</span>  <span class="o">|</span> <span class="mi">00000000</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mf">04.0</span> <span class="n">Off</span> <span class="o">|</span>                    <span class="mi">0</span> <span class="o">|</span>
<span class="o">|</span> <span class="n">N</span><span class="o">/</span><span class="n">A</span>   <span class="mi">35</span><span class="n">C</span>    <span class="n">P0</span>    <span class="mi">27</span><span class="n">W</span> <span class="o">/</span> <span class="mi">250</span><span class="n">W</span> <span class="o">|</span>      <span class="mi">0</span><span class="n">MiB</span> <span class="o">/</span> <span class="mi">16280</span><span class="n">MiB</span> <span class="o">|</span>      <span class="mi">0</span><span class="o">%</span>      <span class="n">Default</span> <span class="o">|</span>
<span class="o">|</span>                               <span class="o">|</span>                      <span class="o">|</span>                  <span class="n">N</span><span class="o">/</span><span class="n">A</span> <span class="o">|</span>
<span class="o">+-------------------------------+----------------------+----------------------+</span>
                                                                               
<span class="o">+-----------------------------------------------------------------------------+</span>
<span class="o">|</span> <span class="n">Processes</span><span class="p">:</span>                                                                  <span class="o">|</span>
<span class="o">|</span>  <span class="n">GPU</span>   <span class="n">GI</span>   <span class="n">CI</span>        <span class="n">PID</span>   <span class="n">Type</span>   <span class="n">Process</span> <span class="n">name</span>                  <span class="n">GPU</span> <span class="n">Memory</span> <span class="o">|</span>
<span class="o">|</span>        <span class="n">ID</span>   <span class="n">ID</span>                                                   <span class="n">Usage</span>      <span class="o">|</span>
<span class="o">|=============================================================================|</span>
<span class="o">|</span>  <span class="n">No</span> <span class="n">running</span> <span class="n">processes</span> <span class="n">found</span>                                                 <span class="o">|</span>
<span class="o">+-----------------------------------------------------------------------------+</span>
</pre></div>
</div>
</section>
<section id="getting-pytorch-to-run-on-the-gpu">
<h3>2. Getting PyTorch to run on the GPU<a class="headerlink" href="#getting-pytorch-to-run-on-the-gpu" title="Link to this heading">#</a></h3>
<p>Once you’ve got a GPU ready to access, the next step is getting PyTorch to use for storing data (tensors) and computing on data (performing operations on tensors).</p>
<p>To do so, you can use the <a class="reference external" href="https://pytorch.org/docs/stable/cuda.html"><code class="docutils literal notranslate"><span class="pre">torch.cuda</span></code></a> package.</p>
<p>Rather than talk about it, let’s try it out.</p>
<p>You can test if PyTorch has access to a GPU using <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.cuda.is_available.html#torch.cuda.is_available"><code class="docutils literal notranslate"><span class="pre">torch.cuda.is_available()</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for GPU</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<p>If the above outputs <code class="docutils literal notranslate"><span class="pre">True</span></code>, PyTorch can see and use the GPU, if it outputs <code class="docutils literal notranslate"><span class="pre">False</span></code>, it can’t see the GPU and in that case, you’ll have to go back through the installation steps.</p>
<p>Now, let’s say you wanted to setup your code so it ran on CPU <em>or</em> the GPU if it was available.</p>
<p>That way, if you or someone decides to run your code, it’ll work regardless of the computing device they’re using.</p>
<p>Let’s create a <code class="docutils literal notranslate"><span class="pre">device</span></code> variable to store what kind of device is available.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set device type</span>
<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>
<span class="n">device</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;cuda&#39;
</pre></div>
</div>
</div>
</div>
<p>If the above output <code class="docutils literal notranslate"><span class="pre">&quot;cuda&quot;</span></code> it means we can set all of our PyTorch code to use the available CUDA device (a GPU) and if it output <code class="docutils literal notranslate"><span class="pre">&quot;cpu&quot;</span></code>, our PyTorch code will stick with the CPU.</p>
<blockquote>
<div><p><strong>Note:</strong> In PyTorch, it’s best practice to write <a class="reference external" href="https://pytorch.org/docs/master/notes/cuda.html#device-agnostic-code"><strong>device agnostic code</strong></a>. This means code that’ll run on CPU (always available) or GPU (if available).</p>
</div></blockquote>
<p>If you want to do faster computing you can use a GPU but if you want to do <em>much</em> faster computing, you can use multiple GPUs.</p>
<p>You can count the number of GPUs PyTorch has access to using <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.cuda.device_count.html#torch.cuda.device_count"><code class="docutils literal notranslate"><span class="pre">torch.cuda.device_count()</span></code></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Count number of devices</span>
<span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">device_count</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1
</pre></div>
</div>
</div>
</div>
<p>Knowing the number of GPUs PyTorch has access to is helpful incase you wanted to run a specific process on one GPU and another process on another (PyTorch also has features to let you run a process across <em>all</em> GPUs).</p>
</section>
<section id="getting-pytorch-to-run-on-apple-silicon">
<h3>2.1 Getting PyTorch to run on Apple Silicon<a class="headerlink" href="#getting-pytorch-to-run-on-apple-silicon" title="Link to this heading">#</a></h3>
<p>In order to run PyTorch on Apple’s M1/M2/M3 GPUs you can use the <a class="reference external" href="https://pytorch.org/docs/stable/notes/mps.html"><code class="docutils literal notranslate"><span class="pre">torch.backends.mps</span></code></a> module.</p>
<p>Be sure that the versions of the macOS and Pytorch are updated.</p>
<p>You can test if PyTorch has access to a GPU using <code class="docutils literal notranslate"><span class="pre">torch.backends.mps.is_available()</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Check for Apple Silicon GPU</span>
<span class="kn">import</span> <span class="nn">torch</span>
<span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="c1"># Note this will print false if you&#39;re not running on a Mac</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set device type</span>
<span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;mps&quot;</span> <span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">()</span> <span class="k">else</span> <span class="s2">&quot;cpu&quot;</span>
<span class="n">device</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&#39;mps&#39;
</pre></div>
</div>
</div>
</div>
<p>As before, if the above output <code class="docutils literal notranslate"><span class="pre">&quot;mps&quot;</span></code> it means we can set all of our PyTorch code to use the available Apple Silicon GPU.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="n">torch</span><span class="o">.</span><span class="n">cuda</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cuda&quot;</span> <span class="c1"># Use NVIDIA GPU (if available)</span>
<span class="k">elif</span> <span class="n">torch</span><span class="o">.</span><span class="n">backends</span><span class="o">.</span><span class="n">mps</span><span class="o">.</span><span class="n">is_available</span><span class="p">():</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;mps&quot;</span> <span class="c1"># Use Apple Silicon GPU (if available)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">device</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span> <span class="c1"># Default to CPU if no GPU is available</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="putting-tensors-and-models-on-the-gpu">
<h3>3. Putting tensors (and models) on the GPU<a class="headerlink" href="#putting-tensors-and-models-on-the-gpu" title="Link to this heading">#</a></h3>
<p>You can put tensors (and models, we’ll see this later) on a specific device by calling <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.to.html"><code class="docutils literal notranslate"><span class="pre">to(device)</span></code></a> on them. Where <code class="docutils literal notranslate"><span class="pre">device</span></code> is the target device you’d like the tensor (or model) to go to.</p>
<p>Why do this?</p>
<p>GPUs offer far faster numerical computing than CPUs do and if a GPU isn’t available, because of our <strong>device agnostic code</strong> (see above), it’ll run on the CPU.</p>
<blockquote>
<div><p><strong>Note:</strong> Putting a tensor on GPU using <code class="docutils literal notranslate"><span class="pre">to(device)</span></code> (e.g. <code class="docutils literal notranslate"><span class="pre">some_tensor.to(device)</span></code>) returns a copy of that tensor, e.g. the same tensor will be on CPU and GPU. To overwrite tensors, reassign them:</p>
<p><code class="docutils literal notranslate"><span class="pre">some_tensor</span> <span class="pre">=</span> <span class="pre">some_tensor.to(device)</span></code></p>
</div></blockquote>
<p>Let’s try creating a tensor and putting it on the GPU (if it’s available).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Create tensor (default on CPU)</span>
<span class="n">tensor</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span>

<span class="c1"># Tensor not on GPU</span>
<span class="nb">print</span><span class="p">(</span><span class="n">tensor</span><span class="p">,</span> <span class="n">tensor</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>

<span class="c1"># Move tensor to GPU (if available)</span>
<span class="n">tensor_on_gpu</span> <span class="o">=</span> <span class="n">tensor</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
<span class="n">tensor_on_gpu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3]) cpu
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3], device=&#39;mps:0&#39;)
</pre></div>
</div>
</div>
</div>
<p>If you have a GPU available, the above code will output something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">])</span> <span class="n">cpu</span>
<span class="n">tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cuda:0&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice the second tensor has <code class="docutils literal notranslate"><span class="pre">device='cuda:0'</span></code>, this means it’s stored on the 0th GPU available (GPUs are 0 indexed, if two GPUs were available, they’d be <code class="docutils literal notranslate"><span class="pre">'cuda:0'</span></code> and <code class="docutils literal notranslate"><span class="pre">'cuda:1'</span></code> respectively, up to <code class="docutils literal notranslate"><span class="pre">'cuda:n'</span></code>).</p>
</section>
<section id="moving-tensors-back-to-the-cpu">
<h3>4. Moving tensors back to the CPU<a class="headerlink" href="#moving-tensors-back-to-the-cpu" title="Link to this heading">#</a></h3>
<p>What if we wanted to move the tensor back to CPU?</p>
<p>For example, you’ll want to do this if you want to interact with your tensors with NumPy (NumPy does not leverage the GPU).</p>
<p>Let’s try using the <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.numpy.html"><code class="docutils literal notranslate"><span class="pre">torch.Tensor.numpy()</span></code></a> method on our <code class="docutils literal notranslate"><span class="pre">tensor_on_gpu</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># If tensor is on GPU, can&#39;t transform it to NumPy (this will error)</span>
<span class="n">tensor_on_gpu</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">TypeError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="nn">/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb Cell 157</span> in <span class="ni">&lt;cell line: 2&gt;</span><span class="nt">()</span>
      <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y312sdnNjb2RlLXJlbW90ZQ%3D%3D?line=0&#39;</span><span class="o">&gt;</span><span class="mi">1</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="c1"># If tensor is on GPU, can&#39;t transform it to NumPy (this will error)</span>
<span class="o">----&gt;</span> <span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s1">&#39;vscode-notebook-cell://ssh-remote%2B7b22686f73744e616d65223a22544954414e2d525458227d/home/daniel/code/pytorch/pytorch-course/pytorch-deep-learning/00_pytorch_fundamentals.ipynb#Y312sdnNjb2RlLXJlbW90ZQ%3D%3D?line=1&#39;</span><span class="o">&gt;</span><span class="mi">2</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span> <span class="n">tensor_on_gpu</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>

<span class="ne">TypeError</span>: can&#39;t convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
</pre></div>
</div>
</div>
</div>
<p>Instead, to get a tensor back to CPU and usable with NumPy we can use <a class="reference external" href="https://pytorch.org/docs/stable/generated/torch.Tensor.cpu.html"><code class="docutils literal notranslate"><span class="pre">Tensor.cpu()</span></code></a>.</p>
<p>This copies the tensor to CPU memory so it’s usable with CPUs.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Instead, copy the tensor back to cpu</span>
<span class="n">tensor_back_on_cpu</span> <span class="o">=</span> <span class="n">tensor_on_gpu</span><span class="o">.</span><span class="n">cpu</span><span class="p">()</span><span class="o">.</span><span class="n">numpy</span><span class="p">()</span>
<span class="n">tensor_back_on_cpu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([1, 2, 3])
</pre></div>
</div>
</div>
</div>
<p>The above returns a copy of the GPU tensor in CPU memory so the original tensor is still on GPU.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tensor_on_gpu</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>tensor([1, 2, 3], device=&#39;cuda:0&#39;)
</pre></div>
</div>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "anukchat/anukchat.github.io",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./content/tools/pytorch"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="pytorch_toc.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Pytorch</p>
      </div>
    </a>
    <a class="right-next"
       href="01_pytorch_workflow.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">PyTorch Workflow Fundamentals</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-is-pytorch">What is PyTorch?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-can-pytorch-be-used-for">What can PyTorch be used for?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#who-uses-pytorch">Who uses PyTorch?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#why-use-pytorch">Why use PyTorch?</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#what-were-going-to-cover-in-this-module">What we’re going to cover in this module</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#importing-pytorch">Importing PyTorch</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#introduction-to-tensors">Introduction to tensors</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-tensors">Creating tensors</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#scalar">Scalar</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#vectors">Vectors</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#matrices">Matrices</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#tensors">Tensors</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#random-tensors">Random tensors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#zeros-and-ones">Zeros and ones</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#creating-a-range-and-tensors-like">Creating a range and tensors like</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tensor-datatypes">Tensor datatypes</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-information-from-tensors">Getting information from tensors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#manipulating-tensors-tensor-operations">Manipulating tensors (tensor operations)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#basic-operations">Basic operations</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#matrix-multiplication-is-all-you-need">Matrix multiplication (is all you need)</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#one-of-the-most-common-errors-in-deep-learning-shape-errors">One of the most common errors in deep learning (shape errors)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#finding-the-min-max-mean-sum-etc-aggregation">Finding the min, max, mean, sum, etc (aggregation)</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#positional-min-max">Positional min/max</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#change-tensor-datatype">Change tensor datatype</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#reshaping-stacking-squeezing-and-unsqueezing">Reshaping, stacking, squeezing and unsqueezing</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#indexing-selecting-data-from-tensors">Indexing (selecting data from tensors)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#pytorch-tensors-numpy">PyTorch tensors &amp; NumPy</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#significance-of-random-seeding">Significance of random seeding</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#running-tensors-on-gpus-and-making-faster-computations">Running tensors on GPUs (and making faster computations)</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-a-gpu">1. Getting a GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pytorch-to-run-on-the-gpu">2. Getting PyTorch to run on the GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#getting-pytorch-to-run-on-apple-silicon">2.1 Getting PyTorch to run on Apple Silicon</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#putting-tensors-and-models-on-the-gpu">3. Putting tensors (and models) on the GPU</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#moving-tensors-back-to-the-cpu">4. Moving tensors back to the CPU</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Anukool Chaturvedi
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>