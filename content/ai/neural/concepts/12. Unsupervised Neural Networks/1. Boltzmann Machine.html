
<!DOCTYPE html>


<html lang="en" data-content_root="../../../../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Boltzmann Machine</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../../../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../../../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../../../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../../../../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/sphinx-design.min.css?v=95c83b7e" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/custom.css?v=ff7e8708" />
    <link rel="stylesheet" type="text/css" href="../../../../../_static/intro.css?v=adbe4504" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../../../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../../../../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../../../../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../../../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../../../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../../../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../../../../_static/design-tabs.js?v=f930bc37"></script>
    <script async="async" src="https://www.googletagmanager.com/gtag/js?id=G-GJG3T4ZRZH"></script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-GJG3T4ZRZH');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../../../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>
                window.dataLayer = window.dataLayer || [];
                function gtag(){ dataLayer.push(arguments); }
                gtag('js', new Date());
                gtag('config', 'G-GJG3T4ZRZH');
            </script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'content/ai/neural/concepts/12. Unsupervised Neural Networks/1. Boltzmann Machine';</script>
    <link rel="canonical" href="https://mlguide.in/content/ai/neural/concepts/12. Unsupervised Neural Networks/1. Boltzmann Machine.html" />
    <link rel="icon" href="../../../../../_static/logo.png"/>
    <link rel="index" title="Index" href="../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../search.html" /> 
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/> 
<link
  rel="alternate"
  type="application/atom+xml"
  href="../../../../resources/blogs/atom.xml"
  title="Blog"
/>
  
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../../../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../../../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../../../../../_static/MLGuide_logo_nb.png" class="logo__image only-light" alt=" - Home"/>
    <script>document.write(`<img src="../../../../../_static/MLGuide_logo_nb.png" class="logo__image only-dark" alt=" - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../python/python_toc.html">Python</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/1_installation.html">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/2_syntax_and_symantics.html">Syntax &amp; Symantics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/3_functions_and_modules.html">Functions &amp; Modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/4_Object_Oriented.html">Object Oriented Programming</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/5_Exceptions_Handling.html">Exceptions Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/6_Handling_Files.html">Handling Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/7_Datetime_Operations.html">Datetime Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/8_advanced.html">Advanced Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/conceptual_topics.html">Interpreter vs Compiler</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../python/exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../statistics/statistics-101.html">Statistics</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../mathematics/mathematics_toc.html">Mathematics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../../mathematics/linear-algebra_vectors.html">Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mathematics/linear-algebra_matrices.html">Matrices</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../mathematics/dissimilarity_measures.html">Similarity measure</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../analytics/intro_analytics.html">Data analytics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../analytics/numpy/numpy_toc.html">Numpy</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../analytics/numpy/001_Python_NumPy.html">NumPy</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../analytics/numpy/Python_Numpy_Exercises_with_hints.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../analytics/pandas/pandas_toc.html">Pandas</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../analytics/pandas/001_Python_Pandas_DataFrame.html">Pandas</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../analytics/pandas/002_Pandas_HowTos.html">How To's</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../analytics/pandas/003_Pandas_Exercises.html">Exercises</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../analytics/matplotlib/matplotlib_toc.html">Matplotlib</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../analytics/matplotlib/001_Python_Matplotlib.html">Matplotlib</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../analytics/matplotlib/003_Python_Matplotlib_Exercises.html">Exercises</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../Introduction_to_ml.html">Machine Learning</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/01_Introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/000_Data_Exploration.html">Exploratory Data Analysis</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/001_Data_Preparation.html">Data Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/002_Regression.html">Regression</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/003_Classification.html">Classfication</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/004_Clustering.html">Clustering</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/005_Evaluation.html">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/006_Advanced.html">K-Fold Cross Validation</a></li>


<li class="toctree-l2"><a class="reference internal" href="../../../classicml/concepts/007_Dimensionality_Reduction.html">Dimensionality Reduction</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../neural_toc.html">Neural Networks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../001_Introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="../002_Backpropogation.html">Backpropogation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../003_Activations.html">Activations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../004_Optimization.html">Optimizations</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../pytorch/pytorch_toc.html">Pytorch</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../pytorch/00_pytorch_fundamentals.html">Fundamentals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pytorch/01_pytorch_workflow.html">Workflow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pytorch/02_pytorch_classification.html">Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pytorch/03_pytorch_computer_vision.html">Computer Vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pytorch/04_pytorch_custom_datasets.html">Custom Datasets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pytorch/06_pytorch_transfer_learning.html">Transfer Learning</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../nlp/nlp_intro.html">Natural Language Processing</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/001_traditional_nlp.html">Word Vectors &amp; Dependency Parsing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/002_embeddings.html">Embeddings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/003_ngram_cnn.html">N Gram using CNN</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/004_word2vec.html">Word2Vec</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/005_language_model_basic.html">Neural Language Model</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/006_language_model_rnn.html">Recurrent Neural Network (RNN)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/007_encoder_decoder.html">Encoder Decoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/008_attention.html">Attention</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/009_transformer.html">Transformer</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/010_llm_tasks.html">Language Modelling Tasks</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../nlp/concepts/011_appendix.html">Appendix</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../../genai/introduction.html">Generative AI</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../genai/prompt-engineering/intro.html">Prompt Engineering</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/prompt-engineering/basic_prompting.html">Basic Prompting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/prompt-engineering/advance_prompts.html">Advanced Prompting</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/prompt-engineering/prompts-applications.html">Prompts Applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/prompt-engineering/prompts-adversarial.html">Prompts Adversarial</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/prompt-engineering/prompts-reliability.html">Reliability</a></li>



</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../../genai/langchain/intro.html">Langchain</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/langchain/01_LangChain_Fundamentals.html">Langchain Cookbook 1</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/langchain/02_LangChain_Use_Cases.html">Langchain Cookbook 2</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../../genai/langchain/projects/project_toc.html">Projects</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../genai/RAG/intro.html">RAG</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../genai/agents/intro.html">Agents</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../genai/llm-recipes/intro.html">LLM Recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../../genai/evaluations/intro.html">Evaluations</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Resources</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../resources/blogs/blogs_toc.html">Blogs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../resources/courses/courses_toc.html">Courses</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../../../../intro_me.html">About me</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/anukchat/mlguide/main?urlpath=lab/tree/content/ai/neural/concepts/12. Unsupervised Neural Networks/1. Boltzmann Machine.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Binder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Binder logo" src="../../../../../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/anukchat/mlguide/blob/main/content/ai/neural/concepts/12. Unsupervised Neural Networks/1. Boltzmann Machine.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../../../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../../../../_sources/content/ai/neural/concepts/12. Unsupervised Neural Networks/1. Boltzmann Machine.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Boltzmann Machine</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#learning-process">Learning Process</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                   <section id="boltzmann-machine">
<h1>Boltzmann Machine<a class="headerlink" href="#boltzmann-machine" title="Link to this heading">#</a></h1>
<p>Boltzmann machine’s learns the internal concepts (not defined by the user) that help to explain the observed data. This is achieved by the hidden units that are connected to the input. Commonly used variant of Boltzmann Machine is the Restricted Boltzmann Machine’s where the hidden units are not connected amongst themselves (this gives a strong performance boost)</p>
<p>Boltzmann Machines try to model the distribution of the data using binary hidden neurons. Furthermore, Boltzmann Machines are Unsupervised Stochastic Neural Networks (stochastic means they have an element of probability in them).</p>
<p>The basic idea of Boltzmann Machine is drawn from concept from Physics which is Energy. Every state is given an energy, and the most likely state will have the least energy. Boltzmann Machine uses Energy function to calculate the probability of each state. The one that has highest probability is the state chosen by the system. The learning is done by the weights that are given to the connections.</p>
<p>Architecture of Boltzmann Machine is as follows:</p>
<ol class="arabic simple">
<li><p>One visible layer: Where the input goes (like the users’ movie ratings)</p></li>
<li><p>One hidden layer: Which calculates these latent features not defined by user</p></li>
<li><p>Bias: A way to adjust the ratings of movie</p></li>
</ol>
<p>Visible layers are connected to hidden layers, but the they are not connected amongst themselves. That is, no visible unit is connect to another visible unit, and no hidden unit is connected to another hidden unit. The bias, on the other hand is connected to both, hidden and visible unit.</p>
<section id="learning-process">
<h2>Learning Process<a class="headerlink" href="#learning-process" title="Link to this heading">#</a></h2>
<p>The learning process of RBMs is using a process called <strong>Contrastive Divergence</strong> which is approximately same as the process of gradient descent.</p>
<p>Intuitive Process:</p>
<ol class="arabic simple">
<li><p>The input at visible node is multiplied by the weights at visible node and passed through activation function which will give the probability of activation of a hidden node.</p></li>
<li><p>Now based on the activation of hidden node, the probability of the activation of visible node is calculated which tries to model the same input that it received first.</p></li>
<li><p>Perform random walk for k times. This is the Contrastive Divergence process.</p></li>
<li><p>At the end of the k steps, if there’s an error, for instance, the input[0] was 1 and the output is 0, the error is backpropagated and the weights, and biases are adjusted accordingly</p></li>
</ol>
<p>Mathematically:</p>
<ol class="arabic simple">
<li><p>Activation of a hidden unit is given by:
$<span class="math notranslate nohighlight">\(a = \sum_i{w_{ij}x_i + b}\)</span><span class="math notranslate nohighlight">\(
and the probability is \)</span><span class="math notranslate nohighlight">\(p(x) = \sigma(a)\)</span><span class="math notranslate nohighlight">\(
where, \)</span>\sigma(x)$ is the sigmoid activation function</p></li>
<li><p>TODO: The derivation of energy function and Contrastive Divergence</p></li>
</ol>
<p>Variation of RBN is the Deep Belief Network. Deep Belief Network is just a stacked RBN. Another variation is Deep Boltzmann Machine which is nearly the same as DBN but the difference is, in DBN all the layers except the last 2 are directed downwards, in DBM there are no such limitations
<img alt="https://qph.ec.quoracdn.net/main-qimg-0f880856d4d1e886bda98ba2b292e6aa" src="https://qph.ec.quoracdn.net/main-qimg-0f880856d4d1e886bda98ba2b292e6aa" /></p>
<p>Useful links:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://www.cs.toronto.edu/~hinton/absps/guideTR.pdf">Detailed algorithm paper by Geoff Hinton</a></p></li>
<li><p><a class="reference external" href="http://blog.echen.me/2011/07/18/introduction-to-restricted-boltzmann-machines/">Intuitive understanding of the algorithm</a></p></li>
<li><p><a class="reference external" href="http://image.diku.dk/igel/paper/AItRBM-proof.pdf">Derivation of Contrastive Divergence</a></p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">torch</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">movies</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ml-1m/movies.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;::&#39;</span><span class="p">,</span> 
                      <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span>
                      <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">movies</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>

<span class="n">users</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ml-1m/users.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;::&#39;</span><span class="p">,</span> 
                      <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span>
                      <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="nb">print</span> <span class="n">users</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
<span class="n">ratings</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ml-1m/ratings.dat&#39;</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;::&#39;</span><span class="p">,</span> 
                      <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">engine</span><span class="o">=</span><span class="s1">&#39;python&#39;</span><span class="p">,</span>
                      <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;latin-1&#39;</span><span class="p">)</span>
<span class="n">ratings</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>   0                                   1                             2
0  1                    Toy Story (1995)   Animation|Children&#39;s|Comedy
1  2                      Jumanji (1995)  Adventure|Children&#39;s|Fantasy
2  3             Grumpier Old Men (1995)                Comedy|Romance
3  4            Waiting to Exhale (1995)                  Comedy|Drama
4  5  Father of the Bride Part II (1995)                        Comedy
   0  1   2   3      4
0  1  F   1  10  48067
1  2  M  56  16  70072
2  3  M  25  15  55117
3  4  M  45   7  02460
4  5  M  25  20  55455
</pre></div>
</div>
<div class="output text_html"><div>
<style>
    .dataframe thead tr:only-child th {
        text-align: right;
    }

    .dataframe thead th {
        text-align: left;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1193</td>
      <td>5</td>
      <td>978300760</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>661</td>
      <td>3</td>
      <td>978302109</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>914</td>
      <td>3</td>
      <td>978301968</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>3408</td>
      <td>4</td>
      <td>978300275</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>2355</td>
      <td>5</td>
      <td>978824291</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">training_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ml-100k/u1.base&#39;</span><span class="p">,</span> 
                           <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span> 
<span class="n">test_set</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ml-100k/u1.test&#39;</span><span class="p">,</span> 
                       <span class="n">delimiter</span><span class="o">=</span><span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">values</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Getting the number of users and movies </span>
<span class="n">nb_users</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">training_set</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]),</span>
                   <span class="nb">max</span><span class="p">(</span><span class="n">test_set</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">])))</span>
<span class="n">nb_movies</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">training_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]),</span>
                   <span class="nb">max</span><span class="p">(</span><span class="n">test_set</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">])))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># convert the data into an an array with users </span>
<span class="c1"># in lines and movies in columns.</span>
<span class="c1"># This is because torch expects the data to be</span>
<span class="c1"># in this fashion</span>
<span class="k">def</span><span class="w"> </span><span class="nf">convert</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a list of lists. One list for each user. </span>
<span class="sd">    The rating are from 1 to 5. User that didn&#39;t see </span>
<span class="sd">    the movie will have a rating of 0&quot;&quot;&quot;</span>
    <span class="n">new_data</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">id_users</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">nb_users</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="c1"># take the column with movie ids for this</span>
        <span class="c1"># specific user</span>
        <span class="n">id_movies</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">][</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_users</span><span class="p">]</span> 
        <span class="c1"># same for the ratings</span>
        <span class="n">id_ratings</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">][</span><span class="n">data</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">id_users</span><span class="p">]</span>
        <span class="c1"># we also have to take care of the case where</span>
        <span class="c1"># this user didn&#39;t watch a specific movie</span>
        <span class="c1"># So, create a list of 1682 (total movies) elements</span>
        <span class="c1"># initialized with 0 and set the rating where this</span>
        <span class="c1"># person has watched the movies. </span>
        <span class="n">ratings</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nb_movies</span><span class="p">)</span>
        <span class="n">ratings</span><span class="p">[</span><span class="n">id_movies</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">id_ratings</span>
        <span class="n">new_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">ratings</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">new_data</span>
<span class="n">training_set</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">training_set</span><span class="p">)</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">convert</span><span class="p">(</span><span class="n">test_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Converting the data into torch tensors</span>
<span class="n">training_set</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">training_set</span><span class="p">)</span>
<span class="n">test_set</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">FloatTensor</span><span class="p">(</span><span class="n">test_set</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Convert the ratings into binary 1 (liked) or 0 (not liked)</span>
<span class="c1"># we have to do this because the output of RBM will be </span>
<span class="c1"># 0 if it predicts user will like the movie and 1 if the </span>
<span class="c1"># prediction is yes. </span>

<span class="c1"># ratings will be modified to:</span>
<span class="c1"># 1. Not watched                   -1</span>
<span class="c1"># 2. Ratings 3 and above (liked)    1</span>
<span class="c1"># 3. Ratings 1 or 2 (disliked)      0</span>

<span class="c1"># convert 0 ratings to -1 </span>
<span class="n">training_set</span><span class="p">[</span><span class="n">training_set</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="c1"># convert ratings for 1 and 2 to 0</span>
<span class="c1"># using training_set[training_set &lt;= 2] = 0</span>
<span class="c1"># has inadvertent effect on rows with rating 0</span>

<span class="n">training_set</span><span class="p">[</span><span class="n">training_set</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">training_set</span><span class="p">[</span><span class="n">training_set</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># convert ratings 3 and above to 1</span>
<span class="n">training_set</span><span class="p">[</span><span class="n">training_set</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># same for test set</span>
<span class="n">test_set</span><span class="p">[</span><span class="n">test_set</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>

<span class="n">test_set</span><span class="p">[</span><span class="n">test_set</span> <span class="o">==</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">test_set</span><span class="p">[</span><span class="n">test_set</span> <span class="o">==</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># convert ratings 3 and above to 1</span>
<span class="n">test_set</span><span class="p">[</span><span class="n">test_set</span> <span class="o">&gt;=</span> <span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># creating the RBM architecture</span>

<span class="k">class</span><span class="w"> </span><span class="nc">RBM</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; Creates a Restricted Boltzmann Machine</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        1. hidden :  number of hidden nodes in RBM</span>
<span class="sd">        2. visible : number of visible nodes in RBM</span>
<span class="sd">        &quot;&quot;&quot;</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visible</span><span class="p">,</span> <span class="n">hidden</span><span class="p">):</span>
        <span class="c1"># The weights matrix is the weight of the path connected</span>
        <span class="c1"># from visible node i to hidden node j. Every path</span>
        <span class="c1"># will have a certain weight. </span>
        
        <span class="c1"># initialise the weights according to normal distribution </span>
        <span class="c1"># which has mean of 0 and variance of 1 dimensions will </span>
        <span class="c1"># be hidden x weights. </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">hidden</span><span class="p">,</span> <span class="n">visible</span><span class="p">)</span>
        <span class="c1"># bias_h is the bias of hidden nodes which is required </span>
        <span class="c1"># to calculate the probability of hidden node given </span>
        <span class="c1"># visible node</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">hidden</span><span class="p">)</span>
        <span class="c1"># bias_v is the bias of visible nodes which is required</span>
        <span class="c1"># to calculate the probability of visible node given </span>
        <span class="c1"># visible node</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">visible</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">activate_hidden</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">visible</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This will activate some hidden nodes using the probability </span>
<span class="sd">        of hidden given visible or p(h=1 | v) which is nothing but</span>
<span class="sd">        sigmoid applied to the sum(weights*input + bias). </span>
<span class="sd">        The question then we&#39;ll ask is which hidden units will </span>
<span class="sd">        activate given these active visible nodes. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        1. visible :    These are visible units in p(h=1 | v) or</span>
<span class="sd">                        the current visible nodes that are active.</span>
<span class="sd">                   </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        </span>
<span class="sd">        1. p_h_given_v : Returns the vector (one value for every </span>
<span class="sd">                         hidden node) of float values.</span>
<span class="sd">        </span>
<span class="sd">        2. activated_values : The nodes will be activated according to</span>
<span class="sd">                         bernoulli&#39;s sampling. Which basically works</span>
<span class="sd">                         as follows: If you have a probability of 0.7</span>
<span class="sd">                         Then choose a random number between 0 and 1</span>
<span class="sd">                         if the number is less than 0.7, activate the</span>
<span class="sd">                         node, else leave it off. </span>
<span class="sd">           </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">weight_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">visible</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="o">.</span><span class="n">t</span><span class="p">())</span>
        <span class="c1"># expand as will add a dimension so that bias is applied</span>
        <span class="c1"># to each line of the weight_x</span>
        <span class="n">activation</span> <span class="o">=</span> <span class="n">weight_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_h</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">weight_x</span><span class="p">)</span>
        <span class="c1"># calculate p(h | v)</span>
        <span class="n">p_h_given_v</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p_h_given_v</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">p_h_given_v</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">activate_visible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">hidden</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This will activate visible nodes using the probability </span>
<span class="sd">        of visible given hidden or p(v=1 | h) which is nothing but</span>
<span class="sd">        sigmoid applied to the sum(weights*input + bias). </span>
<span class="sd">        The question then we&#39;ll ask is which visible units will </span>
<span class="sd">        activate given these hidden nodes. </span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        1. hidden :      These are hidden units in p(v=1 | h) or</span>
<span class="sd">                         the current hidden nodes that are active.</span>
<span class="sd">                   </span>
<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        </span>
<span class="sd">        1. p_v_given_h : Returns the vector (one value for every </span>
<span class="sd">                         hidden node) of float values.</span>
<span class="sd">        </span>
<span class="sd">        2. activated_values : The nodes will be activated according to</span>
<span class="sd">                         bernoulli&#39;s sampling. Which basically works</span>
<span class="sd">                         as follows: If you have a probability of 0.7</span>
<span class="sd">                         Then choose a random number between 0 and 1</span>
<span class="sd">                         if the number is less than 0.7, activate the</span>
<span class="sd">                         node, else leave it off. </span>
<span class="sd">           </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This time we don&#39;t need to compute the transpose </span>
        <span class="c1"># since we&#39;re going the other way</span>
        <span class="n">weight_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">hidden</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weights</span><span class="p">)</span>
        <span class="c1"># expand as will add a dimension so that bias is applied</span>
        <span class="c1"># to each line of the weight_x</span>
        <span class="n">activation</span> <span class="o">=</span> <span class="n">weight_x</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias_v</span><span class="o">.</span><span class="n">expand_as</span><span class="p">(</span><span class="n">weight_x</span><span class="p">)</span>
        <span class="c1"># calculate p(v | h)</span>
        <span class="n">p_v_given_h</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sigmoid</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">p_v_given_h</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">bernoulli</span><span class="p">(</span><span class="n">p_v_given_h</span><span class="p">)</span>
    
    <span class="k">def</span><span class="w"> </span><span class="nf">train</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_vector</span><span class="p">,</span> <span class="n">predicted_visible_k</span><span class="p">,</span> 
              <span class="n">p_h_given_v_0</span><span class="p">,</span> <span class="n">p_h_given_v_k</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Performs Contrastive Divergence</span>
<span class="sd">        </span>
<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        </span>
<span class="sd">        1. input_vector :  The original input vector given by the user.</span>
<span class="sd">        </span>
<span class="sd">        2. predicted_visible_k : The visible vector obtained after k</span>
<span class="sd">                           iterations in Contrastive Divergence. </span>
<span class="sd">        </span>
<span class="sd">        3. p_h_given_v_0 : The probabilities of hidden nodes given the</span>
<span class="sd">                           input vector. </span>
<span class="sd">        </span>
<span class="sd">        4. p_h_given_v_k : The probabilities of hidden nodes at the kth</span>
<span class="sd">                           iteration in Contrastive Divergence. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># update weights</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weights</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">input_vector</span><span class="o">.</span><span class="n">t</span><span class="p">(),</span> <span class="n">p_h_given_v_0</span><span class="p">)</span> \
                            <span class="o">-</span> <span class="n">torch</span><span class="o">.</span><span class="n">mm</span><span class="p">(</span><span class="n">predicted_visible_k</span><span class="o">.</span><span class="n">t</span><span class="p">(),</span> 
                                       <span class="n">p_h_given_v_k</span><span class="p">)</span>
        <span class="c1"># the zero in the end of sum() is to preserve the shape</span>
        <span class="c1"># as matrix. </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_v</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">input_vector</span> <span class="o">-</span> <span class="n">predicted_visible_k</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_h</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">p_h_given_v_0</span> <span class="o">-</span> <span class="n">p_h_given_v_k</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="n">visible_nodes_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">training_set</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">hidden_nodes_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">batch_size</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">number_of_epochs</span> <span class="o">=</span> <span class="mi">15</span>
<span class="n">rbm</span> <span class="o">=</span> <span class="n">RBM</span><span class="p">(</span><span class="n">visible_nodes_size</span><span class="p">,</span> <span class="n">hidden_nodes_size</span><span class="p">)</span>

<span class="k">for</span> <span class="n">epoch</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">number_of_epochs</span><span class="p">):</span>
    <span class="n">train_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">counter</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">id_user</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">nb_users</span> <span class="o">-</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">):</span>
        <span class="c1"># visible_k is the configuration of visible nodes after</span>
        <span class="c1"># k iterations.</span>
        <span class="c1"># initially, it is the same as the input vector. </span>
        <span class="n">visible_k</span> <span class="o">=</span> <span class="n">training_set</span><span class="p">[</span><span class="n">id_user</span><span class="p">:</span> <span class="n">id_user</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
        <span class="n">visible_0</span> <span class="o">=</span> <span class="n">training_set</span><span class="p">[</span><span class="n">id_user</span><span class="p">:</span> <span class="n">id_user</span> <span class="o">+</span> <span class="n">batch_size</span><span class="p">]</span>
        <span class="n">p_h_given_v0</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">rbm</span><span class="o">.</span><span class="n">activate_hidden</span><span class="p">(</span><span class="n">visible_0</span><span class="p">)</span>
        <span class="c1"># perform k steps of Contrastive Divergence</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
            <span class="c1"># perform random walk</span>
            
            <span class="c1"># hidden_k are the probabilities of hideen nodes</span>
            <span class="c1"># after k passes</span>
            
            <span class="c1"># initially visible_k = visible_0</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">hidden_k</span> <span class="o">=</span> <span class="n">rbm</span><span class="o">.</span><span class="n">activate_hidden</span><span class="p">(</span><span class="n">visible_k</span><span class="p">)</span>
            <span class="n">_</span><span class="p">,</span> <span class="n">visible_k</span> <span class="o">=</span> <span class="n">rbm</span><span class="o">.</span><span class="n">activate_visible</span><span class="p">(</span><span class="n">hidden_k</span><span class="p">)</span>
            <span class="c1"># reset the nodes where the rating is -1</span>
            <span class="c1"># i.e. where the users didn&#39;t watch the movie. </span>
            <span class="n">visible_k</span><span class="p">[</span><span class="n">visible_0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">visible_0</span><span class="p">[</span><span class="n">visible_0</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">p_h_given_vk</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">rbm</span><span class="o">.</span><span class="n">activate_hidden</span><span class="p">(</span><span class="n">visible_k</span><span class="p">)</span>
        <span class="n">rbm</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">visible_0</span><span class="p">,</span> <span class="n">visible_k</span><span class="p">,</span> <span class="n">p_h_given_v0</span><span class="p">,</span> <span class="n">p_h_given_vk</span><span class="p">)</span>
        <span class="c1"># don&#39;t measure the error where the ratings are -1</span>
        <span class="n">train_loss</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">visible_0</span><span class="p">[</span><span class="n">visible_0</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
                                           <span class="o">-</span> <span class="n">visible_k</span><span class="p">[</span><span class="n">visible_0</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span> <span class="s1">&#39;Epoch: </span><span class="si">{0}</span><span class="se">\t</span><span class="s1">Training Loss: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> 
                                                 <span class="n">train_loss</span><span class="o">/</span><span class="n">counter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Epoch: 1	Training Loss: 0.292761849616
Epoch: 2	Training Loss: 0.251646004149
Epoch: 3	Training Loss: 0.252478372312
Epoch: 4	Training Loss: 0.250084695766
Epoch: 5	Training Loss: 0.250953539255
Epoch: 6	Training Loss: 0.249900776658
Epoch: 7	Training Loss: 0.251415914688
Epoch: 8	Training Loss: 0.250097338458
Epoch: 9	Training Loss: 0.249537683653
Epoch: 10	Training Loss: 0.248545808809
Epoch: 11	Training Loss: 0.249935396027
Epoch: 12	Training Loss: 0.250694418432
Epoch: 13	Training Loss: 0.253130697998
Epoch: 14	Training Loss: 0.249886217562
Epoch: 15	Training Loss: 0.250107781537
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Testing the predictions</span>

<span class="n">test_loss</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">counter</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">id_user</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_users</span><span class="p">):</span>
    <span class="c1"># IMPORTANT: While testing, we start with the</span>
    <span class="c1"># trainin_set data for this user, which will</span>
    <span class="c1"># be used to predict the recommendations for</span>
    <span class="c1"># this user</span>
    <span class="n">visible_predict</span> <span class="o">=</span> <span class="n">training_set</span><span class="p">[</span><span class="n">id_user</span><span class="p">:</span> <span class="n">id_user</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="c1"># the test set contains actual movies watched</span>
    <span class="c1"># by the same person, if our predictions match</span>
    <span class="c1"># the actual results, then we&#39;re doing good. </span>
    <span class="n">visible_target</span> <span class="o">=</span> <span class="n">test_set</span><span class="p">[</span><span class="n">id_user</span><span class="p">:</span> <span class="n">id_user</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>
    <span class="c1"># We have already performed k steps of Contrastive</span>
    <span class="c1"># Divergence, so while testing we need to do it</span>
    <span class="c1"># only once. </span>
    <span class="c1"># Also, we cannot predict when the user hasn&#39;t</span>
    <span class="c1"># watched any movies, so keep that case in mind. </span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">visible_target</span><span class="p">[</span><span class="n">visible_target</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">hidden_predict</span> <span class="o">=</span> <span class="n">rbm</span><span class="o">.</span><span class="n">activate_hidden</span><span class="p">(</span><span class="n">visible</span><span class="p">)</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">visible_predict</span> <span class="o">=</span> <span class="n">rbm</span><span class="o">.</span><span class="n">activate_visible</span><span class="p">(</span><span class="n">hidden_predict</span><span class="p">)</span>
        <span class="c1"># don&#39;t measure the error where the ratings are -1</span>
        <span class="n">test_loss</span> <span class="o">+=</span> <span class="n">torch</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span>
                                <span class="n">visible_target</span><span class="p">[</span><span class="n">visible_target</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]</span>
                                <span class="o">-</span> <span class="n">visible_predict</span><span class="p">[</span><span class="n">visible_target</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="n">counter</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span> <span class="s1">&#39;Test Loss: </span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">epoch</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">test_loss</span><span class="o">/</span><span class="n">counter</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Test Loss: 0.229938048396
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "anukchat/mlguide",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python2",
            path: "./content/ai/neural/concepts/12. Unsupervised Neural Networks"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python2'</script>
<div class="section ablog__blog_comments">
   
</div>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Anukool Chaturvedi
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <div class="social-icons">
    <a href="https://twitter.com/chaturanukool" target="_blank"><i class="fab fa-twitter"></i></a>
    <a href="https://linkedin.com/in/anukool-chaturvedi" target="_blank"><i class="fab fa-linkedin"></i></a>
    <a href="https://github.com/anukchat" target="_blank"><i class="fab fa-github"></i></a>
    </p>
</div>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../../../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../../../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>